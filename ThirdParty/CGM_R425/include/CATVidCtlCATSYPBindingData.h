//===================================================================
// COPYRIGHT DASSAULT SYSTEMES 2013/09/20
//===================================================================
// CATVidCtlCATSYPBindingData.cpp
// Header definition of class CATVidCtlCATSYPBindingData
//===================================================================
//
// Usage notes:
//
//===================================================================
//  2013/09/20 Creation: Code generated by the 3DS wizard
//===================================================================

#ifndef CATVidCtlCATSYPBindingData_H
#define CATVidCtlCATSYPBindingData_H

#include "VisuDialog.h"
#include "CATVidCtl.h"

#include <CATBaseUnknown_WR.h>
class CATSYPBindingSourceData;
class CATSYPEventArgs;
class CATVidCtlTweaker;

//-----------------------------------------------------------------------

class ExportedByVisuDialog CATVidCtlCATSYPBindingData: public CATVidCtl
{
  CATDeclareClass;
public:
// Standard constructors and destructors
// -------------------------------------
CATVidCtlCATSYPBindingData ();

// Overriden methods
void CATSYPModifyEditedProperties();

/**Gets binding embedded tweaker; used to modify its tweaker data(value) when binding changes*/
CATVidCtlTweaker* GetEmbeddedTweaker();
/**Associates i_pEmbeddedTweaker to "this" binding tweaker*/
void SetEmbeddedTweaker(CATVidCtlTweaker* i_pEmbeddedTweaker);

/**Sets source binding data; gives access to targets binding data list*/
void SetBindingSourceData(CATSYPBindingSourceData* i_pSourceBD);
/**Gets binding data*/
CATSYPBindingSourceData* GetBindingSourceData();

/**serialize binding data*/
const CATUnicodeString GetStringValue();
/**set string binding data*/
//void SetStringValue(const CATUnicodeString& i_stringValue);

/**
* Returns the @c BindingRemoved event.
* The @c BindingRemoved event is emitted when a binded tweaker is removed
*
* @par EventProperties
*   - Name: @c "BindingRemoved"
*   - Type of propagation: @c NoPropagation
*   - Type of argument: @ref CATSYPPropertiesChangedEventArgs
* 
* @return the event instance. @c AddRef has NOT been called on the returned pointer.
*/
static CATSYPEvent* BindingRemoved();

/**
* Returns the @c BindingAdded event.
* The @c BindingRemoved event is emitted when a binded tweaker is added
*
* @par EventProperties
*   - Name: @c "BindingAdded"
*   - Type of propagation: @c NoPropagation
*   - Type of argument: @ref CATSYPPropertiesChangedEventArgs
* 
* @return the event instance. @c AddRef has NOT been called on the returned pointer.
*/
static CATSYPEvent* BindingAdded();


/**
* Handles the BindingRemoved event.
* break binding and reset binding data; this enables the embedded tweaker
*/
void OnRemoveBindingCB(const CATUnicodeString &i_eventName, const CATBaseUnknown_var &i_input, CATBaseUnknown_var &o_output);

/**
* connect two properties and
* Dispatchs the BindingAdded event.
*/
void AddBinding(CATBaseUnknown* i_pSourceObject,const CATUnicodeString& i_srcProp,CATBaseUnknown* i_pTargetObject,const CATUnicodeString& i_targetProp,CATUnicodeString i_sourceSypName,CATBaseUnknown* i_pSourceBinding,const CATUnicodeString& i_bindingMode);

protected:
  virtual ~CATVidCtlCATSYPBindingData ();

private:
// Copy constructor and equal operator
// -----------------------------------
CATVidCtlCATSYPBindingData (CATVidCtlCATSYPBindingData &);
CATVidCtlCATSYPBindingData& operator=(CATVidCtlCATSYPBindingData&);

private:
  CATBaseUnknown_WR _wrEmbeddedTweaker;
  CATSYPBindingSourceData* _pSourceBindingData;
  CATUnicodeString _bindingString;
};

//-----------------------------------------------------------------------

#endif
