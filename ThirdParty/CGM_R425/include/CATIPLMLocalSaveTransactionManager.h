//===================================================================
// COPYRIGHT Dassault Systemes 2015/06/22
//===================================================================
// CATIPLMLocalSaveTransactionManager.cpp
// Header definition of class CATIPLMLocalSaveTransactionManager
//===================================================================
//
// Usage notes:
//
//===================================================================
//  2015/06/22 Creation: Code generated by the 3DS wizard
//===================================================================
#ifndef CATIPLMLocalSaveTransactionManager_H
#define CATIPLMLocalSaveTransactionManager_H

#include "CATPLMIntegrationInterfaces.h"
#include "CATBaseUnknown.h"


extern ExportedByCATPLMIntegrationInterfaces  IID IID_CATIPLMLocalSaveTransactionManager;

class CATIPLMRecordRead;
class CATPLMCompletionLevel;

/**
 * @brief Local save transaction manager
 * @details Use this method to add records to PXn when
 * the records are added to the TOS: PXn and TOS must have the same records.
 */
class ExportedByCATPLMIntegrationInterfaces CATIPLMLocalSaveTransactionManager : public CATBaseUnknown
{
  CATDeclareInterface;

public:

  /**
   * @brief AddRecord
   * @details Add a record into PXn. Record will be actually added on commit.
   *
   * @param iRecord : the record that will be added to the TOS and must be added
   * in PXn too.
   * @param iCompletionLevel The completion level of the record.
   *
   * @return
   * S_OK: succeess
   * S_FALSE: no reserved cell in session
   * E_FAIl: failure
   */
  virtual HRESULT AddRecord(CATIPLMRecordRead * iRecord) = 0;

  /**
   * @brief Abort
   * @details Abort the on-going local save transaction
   * @return
   * S_OK: success
   * E_FAIL: failure
   */
  virtual  HRESULT AbortLocalSaveTransaction() = 0;

  /**
   * @brief Commit
   * @details Commit the on-going local save transaction if it is valid
   * @return
   * S_OK: success
   * E_FAIL: failure
   */
  virtual  HRESULT CommitLocalSaveTransaction() = 0;

};

//-----------------------------------------------------------------------

#endif
