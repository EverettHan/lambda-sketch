// COPYRIGHT Dassault Systemes 2007
//===================================================================
//
// PLMIBLAttributesPropagation.h
// Define the PLMIBLAttributesPropagation interface
//
//===================================================================
// Apr 2007  Creation: Code generated by the CAA wizard DOV
//===================================================================

/**
* @level Protected
* @usage U3
*/

#ifndef PLMIBLAttributesPropagation_H
#define PLMIBLAttributesPropagation_H

// Export
#include "PLMBusinessLogicInterfaces.h"

// Inheritance
#include "CATBaseUnknown.h"
#include "CATIType.h"

class CATIInstance_var;

#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedByPLMBusinessLogicInterfaces IID IID_PLMIBLAttributesPropagation;
#else
extern "C" const IID IID_PLMIBLAttributesPropagation;
#endif

/**
* Interface to launch the integration of the business logic definition related to the PLM attributes valuation propagation.
*/
class ExportedByPLMBusinessLogicInterfaces PLMIBLAttributesPropagation: public CATBaseUnknown
{
    CATDeclareInterface;

public:

    /**
    * Propagates public PLM attributes valuation and manage their edition mode (RW or RO).
    *
    * @param iContext
    *   Contextual object that holds the following information:
    *   <ul>
    *       <li> PropagationMode (string): specifies the propagation mode, either "Valuation" or "Edition" </li>
    *       <li> EditAttributeId (string): identifies the public PLM attribute whose modification triggers the propagation </li>
    *   </ul>
    * @param iPLMComponent
    *   Component (may be a proxy) on which the propagation is requested
    * @param iExtensionAxis
    *   Contains the name of the extension when propagating attribute modification on an extension. NULL if called on a type.
    *
    * @return
    *   <ul>
    *       <li> S_OK      if the business logic is successfully integrated </li>
    *       <li> S_FALSE   if their is no business logic to integrate </li>
    *       <li> E_FAIL    if an error occurs. The following error classes and error identifiers can be associated with:
    *           <ul>
    *               <li>   @error PLMBLAttributesPropagationError PLMBLAttributesPropagationError::RunPropagation::InternalError
    *                      The business logic access service failed
    *               </li>
    *               <li>   @error PLMBLAttributesPropagationError PLMBLAttributesPropagationError::RunPropagation::ExecutionError
    *                      The business logic definition execution failed
    *               </li>
    *           </ul>
    *       </li>
    *   </ul>
    */
    virtual HRESULT RunPropagation(CATIInstance_var & iContext,
                                   CATIInstance_var & iPLMComponent,
								   const CATIType_var & iExtensionAxis = NULL_var) = 0;

};

#endif
