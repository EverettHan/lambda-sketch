// COPYRIGHT Dassault Systemes 2003
//===================================================================
//
// CATIGiveDTProperties.h
// Define the CATIGiveDTProperties interface
//
//===================================================================
//
// Usage notes:
//   New interface: describe its use here
//
//===================================================================
//
//  Jun 2003  Creation: Code generated by the CAA wizard  tvq
//===================================================================
#ifndef CATIGiveDTProperties_H
#define CATIGiveDTProperties_H

#include "KnowledgeItf.h"
#include "CATIDesignTable.h"
#include "CATBaseUnknown.h"

#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedByKnowledgeItf IID IID_CATIGiveDTProperties;
#else
extern "C" const IID IID_CATIGiveDTProperties ;
#endif

#define DTAutoLoadNoCopyInModel 1 // when saving external file, design table is not switched in "Copy Data" mode. When loadind document, the file is projected when needed (no need of user interaction)
#define DTUserLoadAndCopyInModel 0 // when saving external file, design table is switched in "Copy Data" mode. When loadind document, the file is not projected automatically (need of user interaction : enovia synchronization)

//------------------------------------------------------------------

/**
* Allows the customization of various aspects of design tables. It has to be implemented on design table fathers to be taken into account.<br>
* It is mandatory to inherit from CATGiveDTPropertiesAdapter.
*/
class ExportedByKnowledgeItf CATIGiveDTProperties: public CATBaseUnknown
{
	CATDeclareInterface;
	
	
public:

	/**
	* Allows design table parent to control if design tables souce files are saved in Enovia. If the method returns E_FAIL, the source file is not saved in Enovia.
	* If the method returns S_OK, the source file of the design table is stored in VPDM when model is saved.
	*/
	virtual HRESULT IntegrateFileInVPDM() = 0;

	/**
	* Allows design table parent to control the way design tables are saved in Enovia if they are : if oMode == DTAutoLoadNoCopyInModel, the file data is not copied in design table feature
	* and file is projected from database as soon as it is needed. If oMode == DTUserLoadAndCopyInModel, the file data is copied in design table feature, and file is not projected until
	* user asks explicitely it.
	*/
	virtual HRESULT GetIntegrationMode(int &oMode) = 0;

	/**
	* Allows design table parent to control the visualization status in Edit Links panel. Default design table behaviour is to be shown if it is 
	* a user design table.<br>
	* Default implementation on adapter returns S_OK if the design table is user, and E_FAIL else...
	* @return
	* S_OK if design table has to be seen, and E_FAIL if not.
	*/
	virtual HRESULT ViewDTInEditLinks(const CATIDesignTable_var &iDt) = 0;
	
	// No constructors or destructors on this pure virtual base class
	// --------------------------------------------------------------
};

CATDeclareHandler(CATIGiveDTProperties, CATBaseUnknown);

//------------------------------------------------------------------

#endif
