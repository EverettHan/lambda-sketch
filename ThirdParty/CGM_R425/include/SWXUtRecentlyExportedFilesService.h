//===================================================================
// COPYRIGHT DS SolidWorks Corporation 2014/06/05
//===================================================================
// SWXUtRecentlyExportedFilesService.cpp
// Header definition of class SWXUtRecentlyExportedFilesService
//===================================================================
//
// Usage notes:
//
//===================================================================
//  2014/06/05 Creation: Code generated by the 3DS wizard
//===================================================================

#ifndef SWXUtRecentlyExportedFilesService_H
#define SWXUtRecentlyExportedFilesService_H

#include "SWXUtGeneral.h"
#include "CATUnicodeString.h"
#include "SWXUtVector.h"

//-----------------------------------------------------------------------

class ExportedBySWXUtGeneral SWXUtRecentlyExportedFilesService : public CATBaseUnknown
{
public:
	// Get the only instance.
	static SWXUtRecentlyExportedFilesService& Get();

public:
	// Standard destructor
	// -------------------------------------
	virtual ~SWXUtRecentlyExportedFilesService ();

	// These enums are serialized; do not renumber or remove.
	enum ExportedFileType
	{
		IMAGE_FILE = 0,
		VIDEO_FILE,
		// Add new types above this line

		NUM_EXPORTED_FILE_TYPES
	};

	// Get all the registered paths for a given file type.  If ibValidPathsOnly is
	// true, then only paths that correspond to currently existing files on the
	// drive will be returned.
	void GetPaths(ExportedFileType iType, SWXUtVector<CATUnicodeString>& oPaths, bool ibValidPathsOnly = true) const;

	// Register the path of a newly exported file of a given type.
	void AddExportedFile(const CATUnicodeString& iPath, ExportedFileType iType);

	// For ODT testing only - this should never need to be called by normal code.
	void ReloadFromRepository() { ReadSettings(); }

private:
	// Constructors and equal operator
	// -----------------------------------
	SWXUtRecentlyExportedFilesService ();
	SWXUtRecentlyExportedFilesService (SWXUtRecentlyExportedFilesService &);
	SWXUtRecentlyExportedFilesService& operator=(SWXUtRecentlyExportedFilesService&);

	void Clear();
	void ReadSettings();
	void WriteSettings();

private:
	SWXUtVector<CATUnicodeString*>	mPathLists[NUM_EXPORTED_FILE_TYPES];
};

#endif
