// COPYRIGHT Dassault Systemes 2005
//===================================================================
//  Oct 2005  Creation: Code generated by the CAA wizard  bes
//===================================================================
#ifndef CATOmbSdsInitialisationServicesForXCAD_H
#define CATOmbSdsInitialisationServicesForXCAD_H

/**
* @level  Protected
* @usage   U1
*/

#include "CATOmbSessionService.h"
#include "CATListOfCATUnicodeString.h"
#include "CATOmbStreamDescriptorFormat.h"

class CATBaseUnknown;
class CATUnicodeString;
class CATVVSUrl;
class CATDocument;
class CATComponentId;
class CATOmbLoadableDataUniqueKey;
class CATOmbSessionContext;
class CATComponentId;

/**
* Class providing services for initialisation of XCAD components.
*/
class ExportedByCATOmbSelectiveLoading CATOmbSdsInitialisationServicesForXCAD : public CATOmbSessionService
{
public:

  /**
  * Constructor
  */
  inline CATOmbSdsInitialisationServicesForXCAD(): CATOmbSessionService(NULL) {}

  //stupid useless virtuality...
  virtual ~CATOmbSdsInitialisationServicesForXCAD() {}

  /** 
  * Initializes a RepRef with V5 or V6 data streams
  *
  * <b>Role</b>
  * This method initializes the Authoring Stream Description structure of the input repRef from a XCAD stream data
  * This method can be called to update a XCAD rep ref. iKey, iAuthoringLatetype and iAuthoringPersistencyType have to be unchanged for updates.
  * 
  * The RepRef must not be switched to any loading mode before operation.
  * The RepRef is globally switched in AuthoringFullEdit_Mode at the end of the operation.
  * Only one authoring SD of the given late type can be created.
  *
  * @param ioComp [inout]
  *   The RepRef for which Authoring Stream Description structure will be set up.
  * @param iKey [in]
  *   The key for the Stream Descriptor that must hold the document
  *   Authorized key is:  CATOmbLoadableDataUniqueKey::Authoring() 
  * @param iAuthoringLatetype [in]
  *   XCAD Latetype of the authoring Stream Descriptor that will be added to the RepRef
  *   Authorized types are:  CATXCAD3DDocument & CATXCAD2DDocument & CATNonCATIADocument 
  * @param iAuthoringPersistencyType[in]
  *   extension of the stream
  * @param iContentUrl [in]
  *   An access to the XCAD stream data to be attached to the RepRef
  *
  * @return
  *   <code>S_OK</code>         the Stream Description structure has been created with success
  *   <code>E_FAIL</code>       unexpected error. 
  *   <code>E_INVALIDARG</code> invalid late type or empty url. 
  */

  HRESULT InitComponentFromNonCATIAUrl(CATBaseUnknown& ioComp, const CATOmbLoadableDataUniqueKey& iKey, const CATUnicodeString& iAuthoringLatetype, const CATUnicodeString& iAuthoringPersistencyType, const CATVVSUrl &iContentUrl);

};
#endif
