// COPYRIGHT Dassault Systemes 2005
//===================================================================
//  Mar 2005  Creation: Code generated by the CAA wizard  bhg
//===================================================================

/**
* @level Private
* @usage U5
*/

#ifndef CATIOmbStreamDescriptorPersistent_H
#define CATIOmbStreamDescriptorPersistent_H

#include "AC0XXLNK.h"
#include "CATBaseUnknown.h"

#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedByAC0XXLNK IID IID_CATIOmbStreamDescriptorPersistent;
#else
extern "C" const IID IID_CATIOmbStreamDescriptorPersistent;
#endif

//------------------------------------------------------------------
class CATILockBytes2;
/**
* This interface is designed for each consumer that manage a kind of document.<BR>
* By implementing this interface, consumers allow their document to stream or unstream in
* a PDM environment.
*/
class ExportedByAC0XXLNK CATIOmbStreamDescriptorPersistent: public CATBaseUnknown
{
  CATDeclareInterface;

  public:
    /** 
    * Unstreams data of this document from a given stream descriptor.
    * <br><b>Role</b>: This method allows a document to load itself from its data stream
    * without any knowledge from where the data are physically read.
    *
    * @param iILB2 [in]
    *   The stream descriptor from where the document's data are read.
    * @return
    *   <UL>
    *     <LI><code>S_OK</code>: if the loading was successfull.</LI>
    *     <LI><code>E_FAIL</code>: if the loading failed.</LI>
    *   </UL>
    */
    virtual HRESULT ConsumeStream(CATILockBytes2* iILB2) = 0;

    /** 
    * Streams document's data into a stream descriptor.
    * <br><b>Role</b>: This method allows a document to stream itself into a data stream.
    * @param iILB2
    *   The stream descriptor where the document's data will be stored.
    * @return
    *   <code>S_OK</code> if everything ran ok, otherwise <code>E_FAIL</code>.
    */
    virtual HRESULT ProduceStream(CATILockBytes2* ioILB2) = 0;
};

//------------------------------------------------------------------
CATDeclareHandler( CATIOmbStreamDescriptorPersistent, CATBaseUnknown );

#endif
