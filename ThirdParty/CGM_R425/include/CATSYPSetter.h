// COPYRIGHT Dassault Systemes 2007
//===================================================================
//
// CATSYPSetter.h
// Header definition of CATSYPSetter
//
//===================================================================
//
// Usage notes:
//
//===================================================================
//
//  Mar 2007  Creation: Code generated by the CAA wizard  jov
//===================================================================
#ifndef CATSYPSetter_H
#define CATSYPSetter_H

#include <IntroInfra.h>
#include <CATSYPTriggerAction.h>
#include <CATISYPCollection.h>
#include <CATUnicodeString.h>

class CATSYPMappingTablePointerToPointer;

class ExportedByIntroInfra CATSYPSetter: public CATSYPTriggerAction
{
  CATDeclareClass;

public:
  // Standard constructor
  // --------------------
  CATSYPSetter ();

  void SetValue(const CATBaseUnknown_var& _spValue);
  const CATBaseUnknown_var& GetValue() const;

  void SetProperty ( const CATUnicodeString& i_property);
  const CATUnicodeString& GetProperty () const;

  void SetTarget (CATBaseUnknown* i_pTarget);
  void SetIndex (CATBaseUnknown* i_pIndex);
  void SetValueToTarget (const CATBaseUnknown_var &i_spPropertyValue);

  virtual bool Start() override;

protected:
	virtual ~CATSYPSetter ();
private:
  // Copy constructor and equal operator
  // -----------------------------------
  CATSYPSetter (CATSYPSetter &);
  CATSYPSetter& operator=(CATSYPSetter&);
  void ReinterpretValue();
private:
  CATUnicodeString _property;
  CATUnicodeString _type;
  CATSysWeakRef* _pTargetWR;
  CATSysWeakRef* _pIndexWR;
  CATBaseUnknown_var _spValue;

friend class CATSYPDynamicTreeVisitor;

};
//-----------------------------------------------------------------------

#endif
