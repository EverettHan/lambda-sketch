// COPYRIGHT Dassault Systemes 2009
//===================================================================
//
// PLMIRepReferenceDataAccess.h
// Define the PLMIRepReferenceDataAccess interface
//
//===================================================================
//
// Usage notes:
//   New interface: describe its use here
//
//===================================================================
//
//  Jul 2009  Creation: Code generated by the CAA wizard  LVT
//===================================================================
#ifndef PLMIRepReferenceDataAccess_H
#define PLMIRepReferenceDataAccess_H

/**
 * @level Protected
 * @usage U3
 */

#include "CATPLMModelerRepInterfaces.h"

// --- System framework
#include "CATBaseUnknown.h"

#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedByCATPLMModelerRepInterfaces IID IID_PLMIRepReferenceDataAccess;
#else
extern "C" const IID IID_PLMIRepReferenceDataAccess ;
#endif

//------------------------------------------------------------------

/**
 * Interface dedicated to provide an access to the data associated to a Representation Reference.
 *
 * <br><b>Role</b>: This interface provides means to access to the data associated to a Representation Reference. <br>
 */
class ExportedByCATPLMModelerRepInterfaces PLMIRepReferenceDataAccess: public CATBaseUnknown
{
CATDeclareInterface;

public:
		/**
		 * Retrieves the document associated to the Representation Reference. <br>
     * No access to the document is provided if the stream associated to the Representation Reference is 
     * a CATData: the method will fail. <br>
     * For other kind of stream, the returned document will depend on the current loading mode of the Representation Reference. <br>
     *
		 *  @param opLoadedData  [CATBaseUnknown#Release]
		 *      The document associated to the Representation Reference. <br>
     *      Output parameter. <br>
     *      This parameter MUST be provided by caller as NULL. This method returns an error otherwise. <br>
     *      This parameter is returned to caller as NULL if method fails. <br>
     *      This parameter is valuated if method succeeds.
     *  @return 
     *      <code>S_OK</code> if the method succeeds. <br>
     *      <code>E_INVALIDARG</code> if parameters provided are unexpected. <br>
     *      <code>E_UNEXPECTED</code> if the stream associated to the Representation Reference is a CATData. <br>
     *      <code>E_FAIL</code> otherwise. <br>
		 */
		virtual HRESULT GetLoadedData(CATBaseUnknown *&opLoadedData) = 0;

  // No constructors or destructors on this pure virtual base class
  // --------------------------------------------------------------
};

CATDeclareHandler(PLMIRepReferenceDataAccess, CATBaseUnknown);

//------------------------------------------------------------------

#endif
