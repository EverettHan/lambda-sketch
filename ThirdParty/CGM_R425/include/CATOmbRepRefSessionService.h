// COPYRIGHT Dassault Systemes 2005
//===================================================================
//  Apr 2005  Creation: Code generated by the CAA wizard  bes
//===================================================================
#ifndef CATOmbRepRefSessionService_H
#define CATOmbRepRefSessionService_H

/**
* @level  Protected
* @usage   U3
*/

#include "CATOmbSelectiveLoading.h"
#include "CATOmbSessionService.h"
#include "CATOmbPersistErrorDef.h"
class CATDocument;
class CATBaseUnknown;
class CATPLMSDProperties;

/**
 * Service grouping calls related to Representation Reference objects loaded in session. 
 * <b>Role</b>: This session service exposes ObjectModelerBase public calls for manipulating RepRef objects. <br>
 * NOTE: <i>Always instanciate this service on the stack.</i>
*/
class ExportedByCATOmbSelectiveLoading CATOmbRepRefSessionService: public CATOmbSessionService
{
public:

	/**
	* Creates the service. 
	*
	* @param ipSessionContext
	*		A pointer to the session to be used as a context for this service. 
	**/
	CATOmbRepRefSessionService(CATOmbSessionContext* ipSessionContext = NULL);
	virtual ~CATOmbRepRefSessionService() {};

	/**
	* Retrieves the RepresentationReference associated to a document in session.  
	* @param iDocument
	*       A reference to a document in session. 
	* @param oRepRef [out, CATBaseUnknown#Release]
	*       An add-refed CATBaseUnknown pointer to the associated representation reference implementation base. 
	* @return 
	*     <ul>
	*       <li> S_OK : Representation Reference succesfully retrieved.
	*		    <li> CATOmb_E_NO_REPREF : The provided document is not associated to any Representation Reference.
	*       <li> E_FAIL : Unexpected error.
	*     </ul>
	*/
	HRESULT GetRepRefForDocument(CATDocument& iDocument, CATBaseUnknown*& oRepRef);

  /**
  * Create a  CATData document and provides infos on it.
  * @param iType
	*       Type of the document to create (for expample Part, CATPart, etc).
	* @param oSDInfos
	*       informations about SD that would be attached to this document.
  * @param oNewDoc
  *       the created document.
  */
  HRESULT CreateCATDataDocumentAndComputeSDProperties(CATPLMSDProperties& oSDInfos, CATDocument*& oNewDoc);

private:

	CATOmbRepRefSessionService(const CATOmbRepRefSessionService&); // cpy ctor not implemented
	CATOmbRepRefSessionService operator=(CATOmbRepRefSessionService&); // cpy ctor not implemented


};

#endif
