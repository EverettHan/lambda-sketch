//===================================================================
// COPYRIGHT DASSAULT SYSTEMES 2012/04/06
//===================================================================
// CATSYPModelWriter.cpp
// Header definition of class CATSYPModelWriter
//===================================================================
//
// Usage notes:
//
//===================================================================
//  2012/04/06 Creation: Code generated by the 3DS wizard
//===================================================================

#ifndef SYPModelWriter_H
#define SYPModelWriter_H

#include "CATStyleProcessor.h"
#include <CATSYPArray.h>
#include <CATSYPModelTagVisitorWriter.h>
class CATSYPModelTemplate;
class CATSYPModelTag;
class CATSYPModelDataBlockFactory;

//-----------------------------------------------------------------------

class ExportedByCATStyleProcessor CATSYPModelWriter
{
public:
// Standard constructors and destructors
// -------------------------------------
CATSYPModelWriter (const CATUnicodeString& i_filename, CATSYPDynArray<const CATSYPModelTemplate*>& i_templatelist);
CATSYPModelWriter (const CATUnicodeString& i_filename, CATSYPDynArray<const CATSYPModelTemplate*>& i_templatelist, CATSYPDynArray<const CATSYPModelDataBlockFactory*>& i_dataBlockFactoryList);
CATSYPModelWriter(const CATSYPModelTemplate* i_pTemplate);
CATSYPModelWriter(const CATSYPModelDataBlockFactory* i_pDataBlockFactory);
CATSYPModelWriter();
virtual ~CATSYPModelWriter ();

/**
* Dump model template to xml style sheet
*/
void Run();

/**
* Dump model template into stream
* @param i_pTag : root tag
* @param o_output: return export root tag in xml string
*/
void RunLight(CATSYPModelTag *i_pTag, CATUnicodeString &o_output, CATSYPModelTagVisitorWriter::Mode i_mode = CATSYPModelTagVisitorWriter::Complete);

/**
* Write templateAsString into xml style sheet
*/
static HRESULT WriteTemplateFromString(const CATUnicodeString& i_filename,const CATUnicodeString& i_templateAsString);

/**
* Set Title comment
* This comment is added to the dump xml file
*/
void SetHeaderComment(const CATSYPDynArray<CATUnicodeString>& i_comments);

private:
// Copy constructor and equal operator
// -----------------------------------
CATSYPModelWriter (CATSYPModelWriter &);
CATSYPModelWriter& operator=(CATSYPModelWriter&);

void WriteDataBlockFactory(CATIXMLPPWriter_var& i_writer, const CATSYPModelDataBlockFactory* i_dataBlockFactory);

CATSYPDynArray<const CATSYPModelTemplate*> _templateList; //list of model template to dump
CATSYPDynArray<const CATSYPModelDataBlockFactory*> _dataBlockFactoryList; //list of model data block factory to dump
CATUnicodeString _filename;
CATSYPDynArray<CATUnicodeString> _comments;
};

//-----------------------------------------------------------------------

#endif
