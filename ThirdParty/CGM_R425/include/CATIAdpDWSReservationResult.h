//===================================================================
// COPYRIGHT Dassault Systemes 2015/01/30
//===================================================================
// CATIAdpDWSReservationResult.cpp
// Header definition of class CATIAdpDWSReservationResult
//===================================================================
//
// Usage notes:
//
//===================================================================
//  2015/01/30 Creation: Code generated by the 3DS wizard
//===================================================================
#ifndef CATIAdpDWSReservationResult_H
#define CATIAdpDWSReservationResult_H

#include "CATPLMIntegrationAccess.h"
#include "CATUuid.h"
#include "CATTime.h"
#include "CATUnicodeString.h"
#include "CATPLMID.h"
#include "CATBaseUnknown.h"


/**
 * Structure to store the info about the reservation of a component.
 * The info may refer to either one of:
 * - The LOCAL reservation status of a component in a workspace.
 * - The PARENT reservation status of a component in the reference.
 */
struct CATAdpDWSReservationInfo
{
  /**
   * TRUE if the component is reserved, FALSE otherwise.
   * If FALSE, then the value of the other members is undefined (and irrelevant).
   */
  CATBoolean reserved;
  /**
   * The user that performed the reservation (only if reserved).
   */
  CATUnicodeString owner;
  /**
   * The date when the reservation was performed (only if reserved).
   */
  CATUnicodeString date;
  /**
   * The workspace which performed the reservation (only if reserved).
   */
  CATUuid workspaceId;

  /**
   * @nodoc
   */
  CATAdpDWSReservationInfo() : reserved(FALSE), workspaceId(NULL) {}
  /**
   * @nodoc
   */
  CATAdpDWSReservationInfo(CATBoolean iReserved, const CATUnicodeString & iOwner, const CATUnicodeString & iDate, const CATUuid & iWorkspaceId) : reserved(iReserved), owner(iOwner), date(iDate), workspaceId(iWorkspaceId) {}
};


/**
 * Interface to browse the result of a @href CATAdpDWSReservationQuery.
 * Provides direct access to a component reservation info, or iterates on all
 * the components.
 * 
 * Usage 1: Direct access to a component reservation info
 *  CATPLMID comp = ...
 *  CATIAdpDWSReservationResult * pResult = ...
 *  // Execute the query and retrieve the result object...
 *  CATAdpDWSReservationInfo info;
 *  if (SUCCEEDED(pResult->GetParentReservationInfo(comp, info)))
 *  {
 *    // Process the info here
 *  }
 *  
 * Usage 2: Iteration on all the components
 *  CATIAdpDWSReservationResult * pResult = ...
 *  // Execute the query and retrieve the result object...
 *  pResult->StartIteration();
 *  CATPLMID comp;
 *  CATAdpDWSReservationInfo info;
 *  while (pResult->NextParentReservationInfo(comp, info) == S_OK)
 *  {
 *    // Process the PARENT info for component in reference here
 *  }
 *  while (pResult->NextLocalReservationInfo(comp, info) == S_OK)
 *  {
 *    // Process the LOCAL info for component in workspace here
 *  }
 *  
 *  
 * @see CATAdpDWSReservationQuery
 */
class ExportedByCATPLMIntegrationAccess CATIAdpDWSReservationResult : public CATBaseUnknown
{
public:
  /**
   * Retrieves the PARENT reservation info for a component.
   * The PARENT reservation info must have been requested for this component.
   * @param iComponent [in] The component.
   * @param oReservationInfo [out] The PARENT reservation info.
   * @return
   *  Legal values:
   *  <ul>
   *    <li><code>S_OK</code>The reservation info was successfully retrieved.
   *    </li>
   *    <li><code>E_FAIL</code>The PARENT reservation info is not available for 
   *      this component (either not requested, not returned or in error).</li>
   *    <li><code>E_UNEXPECTED</code>The method failed.</li>
   *  </ul>
   */
  virtual HRESULT GetParentReservationInfo(const CATPLMID & iComponent, CATAdpDWSReservationInfo & oReservationInfo) = 0;
  
  /**
   * Retrieves the LOCAL reservation info for a component.
   * The LOCAL reservation info must have been requested for this component.
   * @param iComponent [in] The component.
   * @param oReservationInfo [out] The LOCAL reservation info.
   * @return
   *  Legal values:
   *  <ul>
   *    <li><code>S_OK</code>The reservation info was successfully retrieved.
   *    </li>
   *    <li><code>E_FAIL</code>The LOCAL reservation info is not available for 
   *      this component (either not requested, not returned or in error).</li>
   *    <li><code>E_UNEXPECTED</code>The method failed.</li>
   *  </ul>
   */
  virtual HRESULT GetLocalReservationInfo(const CATPLMID & iComponent, CATAdpDWSReservationInfo & oReservationInfo) = 0;

  /**
   * Prepares the object to iterate on the reservation infos (PARENT and LOCAL).
   * @return 
   *  Legal values:
   *  <ul>
   *    <li><code>S_OK</code>The method succeeded.</li>
   *    <li><code>E_UNEXPECTED</code>The method failed.</li>
   *  </ul>
   */
  virtual HRESULT StartIteration() = 0;
  
  /**
   * Retrieves the PARENT reservation info for the next component.
   * @param oComponent [out] The component which the reservation info was 
   *  retrieved for.
   * @param oReservationInfo [out] The PARENT reservation info for the component.
   * @return 
   *  Legal values:
   *  <ul>
   *    <li><code>S_OK</code>The next reservation info was successfully retrieved.</li>
   *    <li><code>S_FALSE</code>No more reservation info to retrieve.</li>
   *    <li><code>E_UNEXPECTED</code>The method failed (was #StartIteration 
   *      called?).</li>
   *  </ul>
   */
  virtual HRESULT NextParentReservationInfo(CATPLMID & oComponent, CATAdpDWSReservationInfo & oReservationInfo) = 0;

  /**
   * Retrieves the LOCAL reservation info for the next component.
   * @param oComponent [out] The component which the reservation info was 
   *  retrieved for.
   * @param oReservationInfo [out] The LOCAL reservation info for the component.
   * @return 
   *  Legal values:
   *  <ul>
   *    <li><code>S_OK</code>The next reservation info was successfully retrieved.</li>
   *    <li><code>S_FALSE</code>No more reservation info to retrieve.</li>
   *    <li><code>E_UNEXPECTED</code>The method failed (was #StartIteration 
   *      called?).</li>
   *  </ul>
   */
  virtual HRESULT NextLocalReservationInfo(CATPLMID & oComponent, CATAdpDWSReservationInfo & oReservationInfo) = 0;

};

//-----------------------------------------------------------------------

#endif
