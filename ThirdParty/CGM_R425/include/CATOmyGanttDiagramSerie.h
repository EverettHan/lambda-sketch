//===================================================================
// COPYRIGHT Dassault Systemes 2017/12/04
//===================================================================
// CATOmyGanttDiagramSerie.cpp
// Header definition of class CATOmyGanttDiagramSerie
//===================================================================
//
// Usage notes:
// This is a the whole diagram: header + entries + footer
//
//===================================================================
//  2017/12/04 Creation: Code generated by the 3DS wizard
//===================================================================

#ifndef CATOmyGanttDiagramSerie_H
#define CATOmyGanttDiagramSerie_H

#include "CATOmyGanttDiagram.h"
#include "CATOmyGanttDiagramEntry.h"
#include "CATOmxList.h"
#include "CATOmxTextStream.h"
#include "CATOmxJsonObject.h"

class ExportedByCATOmyGanttDiagram CATOmyGanttDiagramSerie
{
public:
  CATOmyGanttDiagramSerie(const CATOmxJsonObject& iConfig);
  virtual ~CATOmyGanttDiagramSerie();

  void AddEntry(CATOmyGanttDiagramEntry& iEntry);
  void Dump(CATOmxTextStream& ioTextStream);

private:
  CATOmyGanttDiagramSerie (CATOmyGanttDiagramSerie &);
  CATOmyGanttDiagramSerie& operator=(CATOmyGanttDiagramSerie&);

  void _DumpHeader(CATOmxTextStream& ioTextStream);
  void _DumpEntry(CATOmxTextStream& ioTextStream, CATOmyGanttDiagramEntry& iEntry);
  void _WriteDiagramEntry(CATOmxTextStream& ioTextStream, CATOmyGanttDiagramEntry& iEntry);

  void _NewLine(CATOmxTextStream& ioTextStream);
  void _NewLineSeparator(CATOmxTextStream& ioTextStream);
  void _WritePadding(CATOmxTextStream& ioTextStream);
  void _WriteSpaces(CATOmxTextStream& ioTextStream, int iSpaceCount);
  void _WriteBorder(CATOmxTextStream& ioTextStream);
  void _WriteInterval(CATOmxTextStream& ioTextStream, int iStartOffet, int iEndOffset, const CATUnicodeString& iRepresentationChar);

  CATOmxList<CATOmyGanttDiagramEntry> _Entries;
  CATLONG64 _MinStartValue;   // min value in _Entries
  CATLONG64 _MaxEndValue;     // max value in _Entries
  CATLONG64 _ElapseValue;     // max - min values

  int _DiagramWidth;
  int _NameColumnWidth;
  int _TypeColumnWidth;
  int _LineWidth;
  int _PaddingSize;
  int _BorderSize;
  CATUnicodeString _Unit;
  CATUnicodeString _LineSeparator;
  CATUnicodeString _Padding;
  CATUnicodeString _Border;

  CATOmxJsonObject _Config;
};

#endif
