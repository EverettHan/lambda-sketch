// COPYRIGHT Dassault Systemes 2003
//===================================================================
//
// CATIXMLMeshMaterialStreaming.h
// Define the CATIXMLMeshMaterialStreaming interface
//
//===================================================================
//
// Usage notes:
//   New interface: describe its use here
//
//===================================================================
//
//  Feb 2003  Creation: Code generated by the CAA wizard  jut
//===================================================================
#ifndef CATIXMLMeshMaterialStreaming_H
#define CATIXMLMeshMaterialStreaming_H

#include "CATVisInteropXMLMesh.h"
#include "CATBaseUnknown.h"
class CATCGRContainer;

#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedByCATVisInteropXMLMesh IID IID_CATIXMLMeshMaterialStreaming;
#else
extern "C" const IID IID_CATIXMLMeshMaterialStreaming ;
#endif

//------------------------------------------------------------------

class CATGraphicMaterial;
class CATISAXContentHandler_var;
class CATIXMLPPWriter_var;

/**
 * Describe the functionality of your interface here
 * <p>
 * Using this prefered syntax will enable mkdoc to document your class.
 */
class ExportedByCATVisInteropXMLMesh CATIXMLMeshMaterialStreaming: public CATBaseUnknown
{
  CATDeclareInterface;

  public:

     /**
      * This method must provide a SAX content handler for material unstreaming.
      * This content handler will be called back on StartElement() / EndElement() / Characters()
      * when reading a MaterialApplication tag.
      */
     virtual HRESULT CreateContentHandler(CATISAXContentHandler_var & oContentHandler) = 0;

     /**
      * This method returns the unstreamed graphic material for the used content handler.
      * iContentHandler : The handler created with CreateContentHandler() method.
      * oMaterial       : The resulting material
      */
     virtual HRESULT GetResultingMaterial(CATISAXContentHandler_var & iContentHandler, CATGraphicMaterial * & oMaterial) = 0;


     /**
      * This method streams the material using the provided XML Writer.
      * iMaterial : The material to stream
      * iWriter   : The XML writer
      */
     virtual HRESULT StreamMaterial(CATGraphicMaterial * iMaterial, CATIXMLPPWriter_var & iWriter) = 0;
};

//------------------------------------------------------------------

#endif
