#ifndef CATSweepSegmentSurface_h
#define CATSweepSegmentSurface_h

// COPYRIGHT DASSAULT SYSTEMES 1999

/**
 * Interface representing a SweepSegment surface.
 *<br> The CATSweepSegmentSurface is created by the <tt>CreateSweepSegmentSurface</tt>
 * method of the <tt>CATGeoFactory</tt> interface. 
 *<br>A CATSweepSegment is the surface generated by ruled surfaces passing through 
 *<tt>SurfacePoints</tt> and <tt>GuidePoints</tt> points. 
 *It keeps its canonicity, and can be a cone, a plane, or a CATGenericRuledSurface
 *for the most general case. This canonical
 * surface is retrieved thanks to the <tt>GetGeometricRep</tt> inherited method.
 *<table>
 * <tr><td>CATMathSetOfPointsND</td><td><tt> Surface1Points </tt></td>
 *                <td> The corresponding points on the first surface </td></tr>
 * <tr><td>CATMathSetOfPointsND</td><td><tt> Surface2Points </tt></td>
 *                <td> The corresponding points on the second surface </td></tr>
 *</table>
 */
 //=============================================================================
// 11/11/19 S9L Streaming changes for support orientation
//              required for sweep extrapolation
// 17/01/20 S9L Added the interface GetSupport
//=============================================================================



#include "CATBaseUnknown.h"
#include "CATSurface.h"
#include "CATConnectBordersCommand.h"  // to include Options Commands of CreateBorders
#include "ExportedByCATGMGeometricInterfaces.h"
class CATGeometry;
class CATCrvParam;
class CATCurve;

#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedByCATGMGeometricInterfaces IID IID_CATSweepSegmentSurface ;
#else
extern "C" const IID IID_CATSweepSegmentSurface ;
#endif

class ExportedByCATGMGeometricInterfaces CATSweepSegmentSurface : public CATSurface
{
  CATDeclareInterface;

public:

	virtual CATLONG32 GetSurfaceOrientation() const= 0;

/**
 * Creates the boundaries of a CATSweepSegmentSurface.
 *<br>The boundaries may degenerate as points.
 * @param iCommand
 * The types of required boundaries.
 *<dl><dt> CreateStartBorder 
 *       <dd>The boundary passing through the <tt>SurfacePoints</tt> 
 *    <dt> CreateEndBorder 
 *       <dd>The boundary passing through the <tt>GuidePoints</tt> 
 *    <dt> CreateSplineBorder1
 *       <dd>The line arc boundary passing through the first point of <tt>SurfacePoints</tt> 
 * and <tt>GuidePoints</tt>.
 *     <dt> CreateSplineBorder1
 *       <dd>The line arc boundary passing through the last point of <tt>SurfacePoints</tt> 
 * and <tt>GuidePoints</tt>.
 *     <dt> sum of the former types <dd>for multiple creation </dl>.
 * @param oSplineBorder1
 * The boundary passing through the <tt>SurfacePoints</tt> according to
 * <tt>iCommand</tt>, NULL otherwise.
 * @param oSplineBorder2
 * The boundary passing through the <tt>GuidePoints</tt> according to
 * <tt>iCommand</tt>, NULL otherwise.
 * @param oStartBorder
 * The line arc boundary passing through the first point of <tt>SurfacePoints</tt>
 * and <tt>GuidePoints</tt> according to <tt>iCommand</tt>, NULL otherwise.
 * @param oEndBorder
 * The line arc boundary passing through the last point of <tt>SurfacePoints</tt>
 * and <tt>GuidePoints</tt> according to
 * <tt>iCommand</tt>, NULL otherwise.
 */
	virtual void CreateBorders( CATGeoFactory *iWhere,
	                            CATConnectBordersCommand iCommand,
	                            CATGeometry *& oSplineBorder1,
                              CATGeometry *& oSplineBorder2,
                              CATGeometry *& oStartBorder, 
                              CATGeometry *& oEndBorder,
                              const CATCrvParam * iSplineStartPosition = 0,
                              const CATCrvParam * iSplineEndPosition = 0,
	                            const CATCrvParam * iStartBorderPosition = 0,
                              const CATCrvParam * iEndBorderPosition = 0,
                              const CATLONG32 iParamID = 0) const =0;

//-------------------------------------------------------------
// GetSurface / GetContact: For iSupportID, use names defined in
// CATConnectDefines.h
//-------------------------------------------------------------
virtual void GetSurface( const CATLONG32 iSupportID,
                         CATSurface * &oSurface,
                         int &oOrientation ) const =0;
  
virtual void GetContact( const CATLONG32 iSupportID,
                         CATGeometry * &oContact) const =0;
//-----------------------------------------------------------
//Get Spine support
//-----------------------------------------------------------
virtual CATCurve* GetSpine() const = 0;

//-----------------------------------------------------------
//Get Support Orientation
// iNumSupp may be either 0 (for support 1) or 1 (for support 2)
//-----------------------------------------------------------
virtual short GetSupportOrientation(int iSupportID) const = 0;

virtual void GetSupport(const CATLONG32 iSupportID,
                        CATGeometry * &opGeometry,
                        int &oOrientation) const = 0;
};  
  CATDeclareHandler(CATSweepSegmentSurface,CATSurface);

#endif
