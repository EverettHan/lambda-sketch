// COPYRIGHT Dassault Systemes 2010
//===================================================================
//
// CATAdpOpenSaveServices.h
// Header definition of CATAdpRestrictedOpenServices
//
//===================================================================
//
// Usage notes:
//
//===================================================================
//
//  Jan 2010  Creation: Code generated by the CAA wizard  ECN
//===================================================================
/**
* @level Protected
* @usage U1  
*/
#ifndef CATAdpRestrictedOpenServices_H
#define CATAdpRestrictedOpenServices_H

#include "CATPLMIntegrationAccess.h"

#include "IUnknown.h"
#include "CATAdpOpenCompletionMode.h"

class CATIAdpPLMIdentificator ;
class CATListPtrCATIAdpPLMIdentificator;
class CATListPtrCATIPLMComponent;
class CATOmbLoadingModeRuleSet;
class CATIAdpErrorMonitor;
class CATPLMBag;


#define AuthorizedModule                  999
#define CATPLMIntegrationAccess           AuthorizedModule
#define CATDMUPersistency                 AuthorizedModule
#define CATWSPModelClient                 AuthorizedModule //A supprimer. Remplacé par CATWSPServices.
#define CATWSPServices                    AuthorizedModule
#define CATUNICmds                        AuthorizedModule // Universal Editor
#define CATPLMTemplates                   AuthorizedModule // For Templates opening in Live Buildings (mail 16/11/2010)
#define CATImmVPMBaseCmds                 AuthorizedModule // For VPM Nav re-architecture (Mail MTX 26/03/2012)
#if _MK_MODNAME_ == AuthorizedModule
#else
	    #error Forbidden access to CATAdpRestrictedOpenServices from non-infrastructure module
        @error 
#endif
#undef CATPLMIntegrationAccess
#undef CATDMUPersistency
#undef CATWSPModelClient
#undef CATWSPServices
#undef CATUNICmds
#undef CATPLMTemplates
#undef CATImmVPMBaseCmds
//-----------------------------------------------------------------------

/**
* Class to manage restricted services on Open in CATIA session.
*
* <br><b>Role</b>: Provides restricted functions to open data in CATIA.
*/
class ExportedByCATPLMIntegrationAccess CATAdpRestrictedOpenServices
{

  public:

/**
 * @deprecated V6R2012
 * @nodoc
 */
   static HRESULT ExpandAndOpen( CATIAdpPLMIdentificator                        * iRefIdentifier, 
                                 CATListPtrCATIPLMComponent                     & ioOpenedElements, 
                                 const CATAdpOpenCompletionMode::CompletionMode & iCompletionMode
                                                                    =CATAdpOpenCompletionMode::Navigation, 
                                 CATOmbLoadingModeRuleSet                       * iLoadingRules=0,
                                 CATIAdpErrorMonitor                            * iErrorMonitor=0 );

   /*
   * @nodoc
   */
   static HRESULT ExpandAndOpen( CATIAdpPLMIdentificator                        * iRefIdentifier, 
                                 CATPLMBag                                      & ioBag,
                                 CATListPtrCATIPLMComponent                     & ioOpenedElements, 
                                 const CATAdpOpenCompletionMode::CompletionMode & iCompletionMode
                                                                    =CATAdpOpenCompletionMode::Navigation, 
                                 CATOmbLoadingModeRuleSet                       * iLoadingRules=0,
                                 CATIAdpErrorMonitor                            * iErrorMonitor=0 );

 /**
 * @deprecated V6R2012
 * @nodoc
 */
   static HRESULT OpenElement(CATIAdpPLMIdentificator  *  iToBeOpened, 
                              const IID                &  iIID  , 
                              void                    **  oOpenedElement ,
                              CATOmbLoadingModeRuleSet *  iLoadingRules = NULL, 
                              CATIAdpErrorMonitor      *  iopErrorMonitor = NULL);
 /**
 * @nodoc
 */

   static HRESULT OpenElement(CATIAdpPLMIdentificator  *  iToBeOpened, 
                              const IID                &  iIID  , 
                              CATPLMBag                & ioBag,
                              void                    **  oOpenedElement ,
                              CATOmbLoadingModeRuleSet *  iLoadingRules = NULL, 
                              CATIAdpErrorMonitor      *  iopErrorMonitor = NULL);


 /**
 * @deprecated V6R2012
 * @nodoc
 */
   static HRESULT OpenElements(CATListPtrCATIAdpPLMIdentificator & iToBeOpened, 
                               CATListPtrCATIPLMComponent        & ioOpenedElement,
                               CATIAdpErrorMonitor               * iopErrorMonitor,
                               CATOmbLoadingModeRuleSet          * iLoadingRules);
 /**
 * @nodoc
 */
   static HRESULT OpenElements(CATListPtrCATIAdpPLMIdentificator & iToBeOpened, 
                               CATPLMBag                         & ioBag,
                               CATListPtrCATIPLMComponent        & ioOpenedElement, 
                               CATOmbLoadingModeRuleSet          * iLoadingRules,
                               CATIAdpErrorMonitor               * iopErrorMonitor
                               );

};

//-----------------------------------------------------------------------

#endif
