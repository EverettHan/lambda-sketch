// COPYRIGHT Dassault Systemes 2006
//===================================================================
//
// CATIPLMCompDeleteRefTransaction.h
// Define the CATIPLMCompDeleteRefTransaction interface
//
//===================================================================
//
// Usage notes:
//   New interface: describe its use here
//
//===================================================================
//
//  Oct 2006  Creation: Code generated by the CAA wizard  JVM
//===================================================================

/**
* @level Protected
* @usage U3
*/

#ifndef CATIPLMCompDeleteRefTransaction_H
#define CATIPLMCompDeleteRefTransaction_H

#include "CATPLMServicesItf.h"
#include "CATBaseUnknown.h"

#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedByCATPLMServicesItf IID IID_CATIPLMCompDeleteRefTransaction;
#else
extern "C" const IID IID_CATIPLMCompDeleteRefTransaction ;
#endif

//------------------------------------------------------------------
class CATIPLMCompDeleteRefRecordWrite;
class CATUnicodeString;
class CATIPLMCompRecordReadSet;
class CATPLMID;


/**
 * Interface belonging to the <b>Component services</b>.
 * Using this level of abstraction you manipulate only Componet Id without knowing the PDM it belongs to.<br>
 *
 * CATIPLMCompDeleteRefTransaction  manages the list of record (the table of data).
 * The Delete Ref message can be seen as a set of Record and in a record through the CATIPLMCompDeleteRefRecordWrite interface,  you will Delete a Reference Object.
*/
class ExportedByCATPLMServicesItf CATIPLMCompDeleteRefTransaction: public CATBaseUnknown
{
	CATDeclareInterface;

public:

	/**
	*	Returns the name of the transaction. This name can be used by error software to index the error stack (see CATIPLMErrorStack.h)
	* @param oName
	*   The name
	*/
	virtual HRESULT GetName ( CATUnicodeString **oName) = 0;

	/**
	* Creates the next CATIPLMCompDeleteRefRecordWrite corresponding to the given CATPlmID.
	* through the CATIPLMCompDeleteRefRecordWrite interface, you can lock or unlock an Object.
	*
	*	@param  iId
	*			The CATPlmID of the object to modify within the RecordWrite.
	*	@param  oRecordWrite [out, CATBaseUnknown#Release]
	*			The new CATIPLMCompDeleteRefRecordWrite object.
	* @return
	*   Error code of function :
	*   <dl>
	*     <dt>S_OK</dt>
	*     <dd>successfully</dd>
	*     <dt>E_FAIL </dt>
	*     <dd>A problem occurs during the operation. get further information by using CATIPLMErrorStack</dd>
	*   </dl>
	*/
	virtual HRESULT Next (const CATPLMID & iId, CATIPLMCompDeleteRefRecordWrite ** oRecordWrite) = 0;

	/**
	* Execute all the DeleteRef operations included in the transaction. 
	* 
	* This method returns a CATIPLMCompRecordReadSet which allows accessing to the return message. 
	* By calling Next method, analyse the report on each Operation (record) done.
	*
	*	@param  oRecordReportSet [out, CATBaseUnknown#Release]
	*			Provides access to the list of record.(The message)
	* @return
	*   Error code of function :
	*   <dl>
	*     <dt>S_OK</dt>
	*     <dd>Save is successfully.</dd>
	*     <dt>S_FALSE</dt>
	*     <dd>Save entirely or partially failed. A report is available.
	*     Get further information by using CATIPLMCompRecordReadSet returned
	*     </dd>
	*     <dt>E_FAIL </dt>
	*     <dd>A fatal communication problem occurs during the operation.
	*     Get further information by using CATIPLMErrorStack</dd>
	*   </dl>
	*/
	virtual HRESULT ExecuteDeleteRefRequest(CATIPLMCompRecordReadSet ** oRecordReportSet) = 0;

  /**
  * Sets the Action associated to the transaction.
  * Should be done before any ::Next statement to make sure that streaming can be acheived.
  *	@param  iId
  *			The CATPlmID of the action.
  */
  virtual HRESULT SetAction(const CATPLMID & iId) = 0;

  /**
  * Sets the Workspace associated to the transaction.
  * Should be done before any ::Next statement to make sure that streaming can be acheived.
  *	@param  iId
  *			The CATPlmID of the workspace.
  */
  virtual HRESULT SetWorkspace(const CATPLMID & iId) = 0;

};

//------------------------------------------------------------------

#endif
