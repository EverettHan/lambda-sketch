// COPYRIGHT Dassault Systemes 2005
//===================================================================
//  Jun 2005  Creation: Code generated by the CAA wizard  bhg
//===================================================================

/**
 * @level Protected
 * @usage U1
 */
#ifndef CATOmyVVSURLConnectionHolder_H
#define CATOmyVVSURLConnectionHolder_H

#include "CATOMYCuteIO.h"
#include "CATBaseUnknown.h"

class CATOmyCioURLCachedConnection;
class CATOmyPowerIOURLCachedConnection;
class CATVVSURLConnection;
//-----------------------------------------------------------------------

/**
* This object holds a CATVVSURLConnection.
* <br><b>Role</b>: This object is kept by a CATOmbStreamDescriptorObjectImpl. It holds
* a URLCOnnection on a stream cached by cuteIO.<BR>
* This connection is used to open a document from the stream.
*/

class ExportedByCATOMYCuteIO CATOmyVVSURLConnectionHolder: public CATBaseUnknown
{
  CATDeclareClass;
  friend class CATOmyCioUrlUsageCtx;
  friend class CATOmbLoadingModeTransitionRequest;

  public:

  // Standard constructors and destructors
  // -------------------------------------
   CATOmyVVSURLConnectionHolder ();
   virtual ~CATOmyVVSURLConnectionHolder();

    /** 
    * Gets the connection kept by this hoder.
    * @return
    *   The connection.
    */
    CATVVSURLConnection* GetConnection() const;
    
    /**
     * @deprecated V5R201
     */
    HRESULT GetConnection(CATVVSURLConnection*& oConnection) const;

    /** 
    * Reinitialize the holder.
    * <br><b>Role</b>: This method must be called, when the CATVVSURLConnection retrieved from
    * this holder has been deleted.
    */
    void ReInit();

  private:
  
    void SetConnection(CATOmyPowerIOURLCachedConnection *ipConnection, CATBoolean iMustDelete = TRUE);

    // Hold URLConnection
    CATOmyPowerIOURLCachedConnection *_pPowerIOUrlConnection;
    CATBoolean _MustDelete;
};

//-----------------------------------------------------------------------

#endif
