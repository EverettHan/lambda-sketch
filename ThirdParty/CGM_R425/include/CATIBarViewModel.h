// COPYRIGHT Dassault Systemes 2007
//===================================================================
//
// CATIBarViewModel.h
// Define the CATIBarViewModel interface
//
//===================================================================
//
// Usage notes:
//   MANDATORY: You must derive CATExtIBarViewModel adapter to implement this interface, the interface is subject to change.
//   --------------------------------------------
//
//===================================================================
//
//  Jul 2007  Creation: Code generated by the CAA wizard  ERS
//===================================================================
#ifndef CATIBarViewModel_H
#define CATIBarViewModel_H

#include "CATAfrItf.h"
#include <CATBaseUnknown.h>

#include <CATEventSubscriber.h>
#include <CATString.h>
#include <CATUnicodeString.h>
#include <CATBaseUnknown_var.h>
#include <CATLISTV_CATBaseUnknown.h>
typedef  CATLISTV(CATBaseUnknown_var)  CATListOfCATBaseUnknown_var; 
class CATPixelImage;

class CATMathPointf;
class CATMathPoint2Df;

// Use these values as styles
#define CATBarViewToolbar              0x0001
#define CATBarViewBubble               0x0002

// Use these values as icon states
#define CATBarViewNormalIcon           0x0001
#define CATBarViewPressedIcon          0x0002
#define CATBarViewFocusIcon            0x0004

extern ExportedByCATAfrItf IID IID_CATIBarViewModel;

//------------------------------------------------------------------

/**
 * Interface for implementing a model for a @href CATIBarView.
 * Please derive CATExtIBarViewModel adapter.
 */
class ExportedByCATAfrItf CATIBarViewModel: public CATBaseUnknown
{
  CATDeclareInterface;

  public:

  /**
   * Get components of a Bar element.
   * iBarComponent is NULL_var to ask first level components, if not NULL_var it should be a compound component (box).
   **/
  virtual void GetBarViewComponents (CATBaseUnknown_var iBarComponent, CATListOfCATBaseUnknown_var &oBarComponentList) = 0;

  /**
   * Ask for an information about a Bar element.
   **/
  virtual void GetStyle (CATBaseUnknown_var iBarComponent, int &oStyle) = 0;
  virtual void GetIcon (CATBaseUnknown_var iBarComponent, int iconState, CATUnicodeString &oIconName) = 0;
  virtual void GetShortHelp (CATBaseUnknown_var iBarComponent, CATUnicodeString &oHelp) = 0;
  virtual void GetHelp      (CATBaseUnknown_var iBarComponent, CATUnicodeString &oHelp) = 0;
  virtual void GetLongHelp  (CATBaseUnknown_var iBarComponent, CATUnicodeString &oHelp) = 0;
	virtual void GetRecordName(CATBaseUnknown_var iBarComponent, CATUnicodeString &oName) = 0;
	virtual void GetTitle			(CATBaseUnknown_var iBarComponent, CATUnicodeString &oTitle)= 0;
    /** Dev for CATPixelImage support **/
  virtual CATPixelImage * GetPixelImage(CATBaseUnknown_var iBarComponent, int iconState) = 0;

	virtual void GetTooltipResourcesInfo(CATBaseUnknown_var iBarComponent, CATUnicodeString &oResourcesFile, CATUnicodeString &oResourcesID) = 0;
  /**
   * Positionning management
  **/

  /**
  * Bar 3D anchor point. Initial 3D position for the linked object. A dotted line will link the bar and this point.
  **/
  virtual void GetBarAnchorPoint (CATMathPointf & oPoint3D) = 0;

  /**
  * Bar 2D connection point. Initial position for the bar up left corner.
  **/
  virtual void GetBarConnectionPoint (CATMathPoint2Df & oPoint2D) = 0;

  /**
   * Set the initial position of your bar. Has no effect once the bar is displayed
  **/
  virtual void SetBarAnchorPoint (const CATMathPointf & iPoint3D) = 0;
  virtual void SetBarConnectionPoint (const CATMathPoint2Df & iPoint2D) = 0;

  // Obsolete, has no effect, do not use.
  virtual void SetBarRightCornerPosition (const int iRightPx, const int iTopPx) = 0;


  /**
  * Method called by views to register to model update event.
  **/
  virtual CATCallback RegisterUpdateEvent( CATEventSubscriber *iSubscriber, CATSubscriberMethod iMethod, CATSubscriberData iData )= 0;
  /**
  * Methode called by views to unregister to model update event
  **/
  virtual void UnRegisterUpdateEvent( CATEventSubscriber *iSubscriber, CATCallback iUpdateCallback )= 0;
};

CATDeclareHandler(CATIBarViewModel, CATBaseUnknown);

#endif
