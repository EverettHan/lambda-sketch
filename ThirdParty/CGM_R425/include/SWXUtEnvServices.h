//===================================================================
// COPYRIGHT DS SolidWorks 2010/09/17
//===================================================================
// SWXUtEnvServices.cpp
// Header definition of class SWXUtEnvServices
//===================================================================
//
// Usage notes:
//
//===================================================================
//  2010/09/17 Creation: Code generated by the 3DS wizard
//===================================================================

#ifndef SWXUtEnvServices_H
#define SWXUtEnvServices_H

#include "SWXUtGeneral.h"
#include "CATSysErrorDef.h"
#include "CATUnicodeString.h"

//-----------------------------------------------------------------------

class ExportedBySWXUtGeneral SWXUtEnvServices
{
public:

	// Friendlier wrapper for CATGetEnvValue--no mem worries
	static HRESULT GetEnvValue(const char * iVarName, CATUnicodeString & oRetValue);

	// Get typed env value
	template<typename T> static HRESULT GetConvertedEnvValue(const char * iVarName, T & oRetValue)
	{
		HRESULT hr = E_FAIL;

		CATUnicodeString value;
		if ( SUCCEEDED( GetEnvValue( iVarName, value ) ) )
		{
			T actValue = 0;
			if ( 0 != value.ConvertToNum( &actValue ) )
			{
				oRetValue = actValue;
				hr = S_OK;
			}
		}

		return hr;
	}

	// Given a path in the "settings" directory, return a full path.
	static HRESULT GetPathInSettings(const CATUnicodeString & iPath, CATUnicodeString & oFullPath);

	// Check if variable is set to particular value
	static bool IsVariableSetAndEqualTo(const char * iVarName, const CATUnicodeString & iVarValue);

private:
	// Standard constructors and destructors
	// -------------------------------------
	SWXUtEnvServices ();
	~SWXUtEnvServices ();

	// Copy constructor and equal operator
	// -----------------------------------
	SWXUtEnvServices (SWXUtEnvServices &);
	SWXUtEnvServices& operator=(SWXUtEnvServices&);
};

//-----------------------------------------------------------------------

#endif
