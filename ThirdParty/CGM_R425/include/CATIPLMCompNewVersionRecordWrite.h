// COPYRIGHT Dassault Systemes 2005
//===================================================================
//
// CATIPLMCompNewVersionRecordWrite.h
// Define the CATIPLMCompNewVersionRecordWrite interface
//
//===================================================================
//
// Usage notes:
//   New interface: describe its use here
//
//===================================================================
//  Feb 2005  Creation: Code generated by the CAA wizard  jvm  aa
//===================================================================

/**
* @level Protected
* @usage U3
*/

#ifndef CATIPLMCompNewVersionRecordWrite_H
#define CATIPLMCompNewVersionRecordWrite_H

// BSFBuildtimeData
#include "CATIAV5Level.h"

#include "CATPLMServicesItf.h"
#include "CATBaseUnknown.h"
#include "CATPLMID.h"
#include "CATPLMOmxCollections.h"
#include "CATPLMNLVPropertiesWrite.h"

#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedByCATPLMServicesItf IID IID_CATIPLMCompNewVersionRecordWrite;
#else
extern "C" const IID IID_CATIPLMCompNewVersionRecordWrite;
#endif

class CATPLMTypeId;
class CATPLMType;
class CATIPLMAttrWrite;
class CATString;

/**
* Interface belonging to the <b>Component services</b>.
* Using this level of abstraction you manipulate only Componet Id without knowing the PDM it belongs to.<br>
*
* Provides methods in order to New Version current object.
* This operation can be done under the control of a transaction of the PDM(s).
*/
class ExportedByCATPLMServicesItf CATIPLMCompNewVersionRecordWrite : public CATBaseUnknown
{
  CATDeclareInterface;

public:

  /**
  * Returns the CATPlmId of this Record (of the current object).
  * @param  oId
  *    The PLMId of the object to modify
  * @return
  *   <dl>
  *     <dt>S_OK</dt><dd>Success.</dd>
  *     <dt>E_FAIL </dt><dd>A problem occurs during the operation.</dd>
  *   </dl>
  */
  virtual HRESULT GetPLMId(CATPLMID & oId) = 0;

  /**
  * New version the object already identified.
  *
  * @return
  *   <dl>
  *     <dt>S_OK</dt><dd>Success.</dd>
  *     <dt>E_FAIL </dt><dd>A problem occurs during the operation.</dd>
  *   </dl>
  */
  virtual HRESULT NewVersionObject() = 0;

  /**
  * New minor version the object already identified.
  *
  * @return
  *   <dl>
  *     <dt>S_OK</dt><dd>Success.</dd>
  *     <dt>E_FAIL </dt><dd>A problem occurs during the operation.</dd>
  *   </dl>
  */
  virtual HRESULT NewMinorVersionObject() = 0;

  /**
  * Accepts that the input PLMID is not the last of history line.
  *
  * @return
  *   <dl>
  *     <dt>S_OK</dt><dd>Success.</dd>
  *     <dt>E_FAIL </dt><dd>A problem occurs during the operation.</dd>
  *   </dl>
  */
  virtual HRESULT SetFromAncestor() = 0;

  /**
  * Puts the new version object into the family of the provided PLMID.
  *
  * @return
  *   <dl>
  *     <dt>S_OK</dt><dd>Success.</dd>
  *     <dt>E_FAIL </dt><dd>A problem occurs during the operation.</dd>
  *   </dl>
  */
  virtual HRESULT SetIntoFamilyOf(const CATPLMID& iId = CATPLMID_Null) = 0;

#ifdef CATIAR422
  virtual HRESULT GetIntoFamily(CATPLMID& oId) = 0;
#endif 

  /**
  * Log an attributes update. This method computes a CATIPLMAttrWrite interface for the dedicated object.
  * The return interface will be used by the system to update attributes.
  *
  * @param  oAttrAccess [out, CATBaseUnknown#Release]
  *    interface managing attributes setting
  * @param  iExtensionType
  *    Applicative extension type
  *    if NULL (Default) -> Attributes belong to the Master Bloc (MBSI)
  *    if Valued -> Attributes belong to the Slave Bloc (SBSI) corresponding to iExtensionType
  * @return
  *   <dl>
  *     <dt>S_OK</dt><dd>operation is successfully.</dd>
  *     <dt>E_FAIL</dt><dd>A problem occurs during the operation.</dd>
  *   </dl>
  */
  virtual HRESULT GetAttributeAccess(CATIPLMAttrWrite ** oAttrAccess, const CATPLMTypeId *iExtensionType = NULL) = 0;

  /**
  * Log an attributes update. This method computes a CATIPLMAttrWrite interface for the dedicated object.
  * The return interface will be used by the system to update attributes.
  *
  * @param  oAttrAccess [out, CATBaseUnknown#Release]
  *    interface managing attributes setting
  * @param  iExtensionType
  *    Applicative extension type
  *    if NULL (Default) -> Attributes belong to the Master Bloc (MBSI)
  *    if Valued -> Attributes belong to the Slave Bloc (SBSI) corresponding to iExtensionType
  * @return
  *   <dl>
  *     <dt>S_OK</dt><dd>operation is successfully.</dd>
  *     <dt>E_FAIL</dt><dd>A problem occurs during the operation.</dd>
  *   </dl>
  */
  virtual HRESULT GetAttributeAccess(const CATString * iExtensionType, CATIPLMAttrWrite ** oAttrAccess) = 0;

  /**
  * Log an attributes update. This method computes a CATIPLMAttrWrite interface for the dedicated object.
  * The return interface will be used by the system to update attributes.
  *
  * @param  ipExtensionType
  *    Applicative extension type
  *    if NULL (Default) -> Attributes belong to the Master Bloc (MBSI)
  *    if Valued -> Attributes belong to the Slave Bloc (SBSI) corresponding to iExtensionType
  * @param  opAttrAccess [out, CATBaseUnknown#Release]
  *    interface managing attributes setting
  * @return
  *   <dl>
  *     <dt>S_OK</dt><dd>operation is successfully.</dd>
  *     <dt>E_FAIL</dt><dd>A problem occurs during the operation.</dd>
  *   </dl>
  */
  virtual HRESULT GetAttributeAccess(CATPLMType* ipExtensionType, CATIPLMAttrWrite*& opAttrAccess) = 0;

  virtual CATPLMOrderedOSetOfTypeH GetListExtension() const = 0;

  virtual HRESULT SetProperties(const CATPLMNLVPropertiesWrite & iProperties) = 0;

  virtual HRESULT GetProperties(CATPLMNLVPropertiesWrite & oProperties) = 0;

  virtual HRESULT GetCEStamp(CATPLMCEStamp& oCEStamp) const = 0;

  virtual CATPLMCEStamp GetCEStamp() const = 0;
};

#endif
