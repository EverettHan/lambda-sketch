// COPYRIGHT Dassault Systemes 2006
//===================================================================
//
// CATPLMQLServices.h
// 
//
//===================================================================
//===================================================================
//
//  Jul 2006  Creation: Code generated by hand				  HSU
//===================================================================
#ifndef CATPLMQLServices_H
#define CATPLMQLServices_H

//for exported by
#include "CATPLMQLCPPParser.h"

//services
#include "CATPLMRepositoryName.h"

//fwd decl...
class CATIPLMCompRecordReadSet;
class CATUnicodeString;
class CATPLMQLbnf_Expressions;


//-----------------------------------------------------------------------

/**
* Class to manage PLMQL services, like Executing Query..
*
* <br><b>Role</b>: This class provides all basic functions to Retrieve the Record read set for Select Query.
*   
*   Exports only a static member function ExecuteStatement.
* Object creation is not Required.
*
*   <ul> The available Exported APIs  are: 
*   <li>ExecuteStatement for  <b>EV5</b> and   all Providers</li>
*   </ul>
*/
class ExportedByCATPLMQLCPPParser CATPLMQLServices
{
public:
	 /**
    * Returns the  Recordset for the input Select Query iQueryStatement.
    * <br><b>Role:</b>This method allows you to get The list of Records from the provider iProviderName repository.
	*@param iQueryStatement
	*	input Select Query.
	*	
	*@iProviderName
	* input provider name
    * @param opRecordReadSet
    *   pointer To output RecordReadSet.User need to release the pointer when useless.
    * @return
    *   <ul>
    *   <li><tt>S_OK</tt>: successfull. </li> 
    *   <li><tt>E_FAIL</tt>: Error during operation.  get further information by using CATIPLMErrorStack</li>
    *   <li><tt>E_INVALIDARG</tt>: Input parameter are not correct.</li>
    *  </ul>
    
	static HRESULT ExecuteStatement(const CATUnicodeString &iQueryStatement, const CATPLMRepositoryName &iProviderName, CATIPLMCompRecordReadSet **opRecordReadSet);
  */
  static HRESULT ParseFile(const char* FilePath, CATPLMQLbnf_Expressions **opStmtExpressions);

  static HRESULT ParseBuffer(const char* Buffer, CATPLMQLbnf_Expressions **opStmtExpressions);

  static HRESULT ParseAndVisit_FilePrint(const char* FilePath, CATUnicodeString& oPLMQLStr);
  static HRESULT ParseAndVisit_BufferPrint(const char* Buffer, CATUnicodeString& oPLMQLStr);
};

#endif
