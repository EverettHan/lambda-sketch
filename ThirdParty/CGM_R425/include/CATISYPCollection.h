#ifndef _CATISYPCollection_H
#define _CATISYPCollection_H

#include <CATBaseUnknown.h>
#include <CATLISTV_CATBaseUnknown.h>
#include <IntroInfra.h>
#include <CATSYPArray.h>

extern ExportedByIntroInfra IID IID_CATISYPCollection;

/** @ingroup groupCIDIntrospection
 * Interface implemented by components that declare themself as a collection
 * of a collection of objects. It is used by style processor, with CATISYPPresenter, to 
 * create the tree of introspectable objects generated by it.
 */
class ExportedByIntroInfra CATISYPCollection : public CATBaseUnknown
{
	CATDeclareInterface;
public:
	/**
	 * Gets item at at requested index.
   * @param i_index the index of the element to retrieve in the collection
   * @return the emelent to retrieve. Will be NULL_var if not found
	 */
	virtual CATBaseUnknown_var GetAt( int i_index ) = 0;
	/**
	 * @return the number of elements of the collection
	 */
	virtual int GetCount() = 0;
	/**
	 * Adds an item to the collection.
   * The implementation of this extention must AddRef the given CATBaseUnknown.
   * The implementation should assert if the object is already contained by the collection.
   * @param i_spObject the object to append to the collection
	 */
	virtual void Append( const CATBaseUnknown_var &i_spObject ) = 0;
	/**
	 * Adds a list of items to the collection.
   * The implementation of this extention must AddRef the given objects.
   * @param a list of objects to add
	 */
	virtual void AppendList( const CATSYPConstArray<CATBaseUnknown_var> &i_list ) = 0;
  /**
   * Removes an item of the collection.
   * The implementation should assert if the object is not member of the collection.
   */
  virtual void Remove( const CATBaseUnknown_var &i_spObject ) = 0;
  /**
   * Removes an item of the collection.
   * The implementation should assert if the object is not member of the collection.
   */
  virtual void RemoveList( const CATSYPConstArray<CATBaseUnknown_var> &i_list ) = 0;
  /**
   * Clears the collection, by removing and releasing all elements.
   */
  virtual void Clear() = 0;
  /**
   * Determine if an object is member of the collection
   */
  virtual int Contains( const CATBaseUnknown_var &i_spObject ) = 0;
	/** @deprecated */
	virtual void Append( const CATLISTV(CATBaseUnknown_var) &i_list ) = 0;
};
CATDeclareHandler( CATISYPCollection, CATBaseUnknown );

#endif

