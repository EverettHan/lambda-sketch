// COPYRIGHT Dassault Systemes 2003
//===================================================================
//
// CATIPLMSaveEngine.h
// Define the CATIPLMSaveEngine interface
//
//===================================================================
//
// Usage notes:
//   New interface: describe its use here
//
//===================================================================
//
//  Dec 2003  Creation: Code generated by the CAA wizard  son
//===================================================================
/**
* @level Protected
* @usage U3
*/
#ifndef CATIPLMSaveEngine_H
#define CATIPLMSaveEngine_H

#include "CATPLMIntegrationInterfaces.h"
#include "CATBaseUnknown.h"

#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedByCATPLMIntegrationInterfaces IID IID_CATIPLMSaveEngine;
#else
extern "C" const IID IID_CATIPLMSaveEngine ;
#endif



class CATListValCATComponentId;
class CATComponentId;
class CATListPtrCATBaseUnknown;
class CATIPLMSaveScope;


#include "CATBoolean.h"






//------------------------------------------------------------------

/**
 * This interface is the external view of the Save Engine.
 * <br><b>Role</b>: it describes how the SaveEngine has to be used by its client
 * 
 * <br>Extract of the PES :
 *   
 * <p><b>1.	Definition of the SaveEngine</b>
 * 
 * <br>The SaveEngine is expected to organize the save process : called by a Save Command, it guarantees the coherence of the objects list to save, manages the save transaction, and launches the save. 
 * <br>The SaveEngine is PDM generic : it can perform save to each kind of PDM. Thanks to the SaveEngine, a generic Save Command will be introduced : in whatever PDM the data are to save, the same command will be used . 
 * <br>The SaveEngine ensures that the catia session data are correct whatever situation happens, successfull save or not.
 * 
 * <p><b>2.	Access to the SaveEngine</b>
 * <br>The save engine is to be created thanks to a dedicated toolbox which creates the integration components (SaveEngine, OpenEngine ...).
 * <br>The toolbox CATPLMEngineToolbox exposes static methods giving access to the dedicated engine 
 * 
 * <br>The only one interface accessible on the SaveEngine for its client is CATIPLMSaveEngine
 *
 * <p>For more information, please refer to  PES_SaveEngine.doc in CATPLMIntegrationInterfaces\Data.d\SaveEngine
 * @see CATPLMEngineToolbox, CATPLMEngineToolbox, CATIPLMEngineListener
 */

class ExportedByCATPLMIntegrationInterfaces CATIPLMSaveEngine: public CATBaseUnknown
{
  CATDeclareInterface;

  public:



/**
* Processes a save transaction.
* @param  ipiSaveScope 
*   The scope of the save. The scope has to be have been defined before calling this Save method.
* @return 
* <br><b>Legal values</b>
*   <dt>S_OK</dt>  
*   <dd>The save succeeded. 
*       <br>Please note that S_OK doesn't mean that no error occured during the save:  it means that a save process has been carried out (maybe rerooted or canceled) in aggreement with the user.
*       <br>Examples : 
*          <br> - If a save domain restriction was necessary, the client has been informed and has chosen to accept and continue or to cancel. The SaveEngine applied its choice successfully.
*          <br> - If a warning error occured, the end user has been informed and has chosen to accept and continue or to cancel.The SaveEngine applied its choice successfully.
*          <br> - In case of connection problem : the user is informed, and the Save Engine restores the session in the state before the Save's call.
*   <br>  In case of cancel (imposed by the Save Engine or chosen by the end user), the S_OK return code guaranteed that the client is corectly informed and that the catia/server sessions are restored in the state before the Save's call.
*   </dd>
*   <dt>E_FAIL</dt>  
*   <dd>System error. Or the dialog through the listener to solve an error situation failed ?
*   </dd>
*   <dt>E_INVALIDARG</dt>  
*   <dd>Invalid argument</dd>
* <br>
* @see CATIPLMSaveScope, CATPLMEngineToolbox,CATIPLMEngineListener
*/
virtual HRESULT Save(CATIPLMSaveScope * ipiSaveScope) =0 ;




};
//------------------------------------------------------------------
CATDeclareHandler( CATIPLMSaveEngine, CATBaseUnknown );

#endif
