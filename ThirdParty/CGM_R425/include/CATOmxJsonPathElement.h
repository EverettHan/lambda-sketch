//===================================================================
// COPYRIGHT Dassault Systemes 2018/06/11
//===================================================================
// CATOmxJsonPathElement.cpp
// Header definition of class CATOmxJsonPathElement
//===================================================================
//
// Usage notes:
//
// Represent a path element of the json path.
// It can be a key (string) for JsonObject.
// Or an index (int) for JsonArray.
//
//===================================================================
//  2018/06/11 Creation: Code generated by the 3DS wizard
//===================================================================

#ifndef CATOmxJsonPathElement_H
#define CATOmxJsonPathElement_H

#include "CATOMYUtils.h"
#include "CATUnicodeString.h"
#include "CATOmxCollecManager.h"
#include "CATOmxJsonItem.h"

class ExportedByCATOMYUtils CATOmxJsonPathElement
{
  enum ElementType
  {
    None,
    FieldName,
    FieldIndex
  };

public:
  CATOmxJsonPathElement();
  CATOmxJsonPathElement(const CATUnicodeString& iFieldName);
  CATOmxJsonPathElement(int iFieldIndex);
  CATOmxJsonPathElement(const CATOmxJsonPathElement& iElement);
  CATOmxJsonPathElement& operator=(const CATOmxJsonPathElement& iElement);
  virtual ~CATOmxJsonPathElement();

  /*
  * Reads the given item's value regarding this path element's type:
  *   FieldName: iItem.GetJsonItem(_FieldName, oValue);
  *     return E_FAIL if iItem is not a JsonObject
  *   FieldIndex: iItem.GetJsonItem(_FieldIndex, oValue);
  *     return E_FAIL if iItem is not a JsonArray
  *
  * @return
  *   S_OK value read correctly
  *   E_TYPEMISMATCH value cannot be read (invalid iItem type (object or array))
  *   E_INVALIDARG current path element is null (type == None)
  */
  HRESULT Read(const CATOmxJsonItem& iItem, CATOmxJsonItem& oValue) const;

private:
  CATUnicodeString _FieldName;
  int _FieldIndex;
  ElementType _Type;
};

template<> CATOmxCollecManager& CATOmxDefaultCollecManager<CATOmxJsonPathElement>::manager();

#endif
