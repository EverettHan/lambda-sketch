// COPYRIGHT Dassault Systemes 2006
//===================================================================
//
// CATIPLMLinkable.h
// Header definition of CATIPLMLinkable
//
//===================================================================
//
// Usage notes:
//
//===================================================================
//
//  Jan 2006  Creation: Code generated by the CAA wizard  ECN
//===================================================================
/**
  * @CAA2Required
  */
#ifndef CATIPLMLinkable_H
#define CATIPLMLinkable_H

#include "CATPLMComponentInterfaces.h"
#include "CATBaseUnknown.h"  

class CATILinkableObject;
class CATIPLMComponent;



#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedByCATPLMComponentInterfaces IID IID_CATIPLMLinkable;
#else
extern "C" const IID IID_CATIPLMLinkable ;
#endif
/**
* Interface to access services from a CATILinkableObject.
*
*
* @example
*  // example is optional
* <pre>
*  CATIPLMLinkable  *  piLink  =  NULL; 
*  HRESULT rc = ::CATInstantiateComponent( "CATPLMLinkable", IID_CATIPLMLinkable, (void **) &piLink);
*  if (SUCCEEDED(rc) && piLink)
*  {
*	  rc = piLink->GetPLMComponent(ipiLinkable,opiComponent);
*	  do not forget to release ...
* </pre>
*	
*/

class ExportedByCATPLMComponentInterfaces CATIPLMLinkable: public CATBaseUnknown
{
  CATDeclareInterface;
   public:

/**
* Retrieves the PLM component associated with a linkable object.
* <br><b>Role:</b> Retrieves the PLM component of a Linkable object if 
* associated with a PLM database persistency.
*
* @param ipiLinkable 
*		The linkable object.
*
* @param opiComponent [out, CATBaseUnknown#Release]
*		The PLM component.
*    <br>Note : the pointer should be <em>RELEASED</em>.
*
* @return
*      <ul>
*       <li><tt>S_OK</tt> if the PLM component has been found.</li>
*       <li><tt>E_INVALIDARG</tt> in such cases :
*           <ul>
*            <li> <tt>ipiLinkable</tt> null.</li> 
*            <li> <tt>ipiLinkable</tt> associated to a complex link.</li> 
*            <li> <tt>opiComponent</tt> component not loaded in session.</li>
*           </ul>
*       <li><tt>E_FAIL</tt> otherwise if unexpected errors.</li>
*      </ul>  
*/

virtual HRESULT GetPLMComponent( CATILinkableObject* ipiLinkable, CATIPLMComponent*& opiComponent)=0;

   
};
#endif
