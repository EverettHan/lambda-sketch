//===================================================================
// COPYRIGHT Dassault Systemes 2015/03/31
//===================================================================
// CATIPLMOperationPrecheckAnalyzer.cpp
// Header definition of class CATIPLMOperationPrecheckAnalyzer
//===================================================================
//
// Usage notes:
//
//===================================================================
//  2015/03/31 Creation: Code generated by the 3DS wizard
//===================================================================
#ifndef CATIPLMOperationPrecheckAnalyzer_H
#define CATIPLMOperationPrecheckAnalyzer_H

#include "CATPLMIntegrationInterfaces.h"
#include "CATBaseUnknown.h"

class CATIAdpErrorMonitor;


extern ExportedByCATPLMIntegrationInterfaces  IID IID_CATIPLMOperationPrecheckAnalyzer ;


/**
 * Listener for the NewMinorVersion engine using <code>IntoFamily</code> mode,
 * enabling the user to analyze the results of the validation step when it is 
 * complete, and choose whether to proceed with the execution of the operation
 * or to cancel it.
 * <br>
 * An instance of this listener must be given to the engine builder through a 
 * call to @href CATPLMComponentManagementBuilder#SetOpenrationPrecheckAnalyzer.
 * 
 * @see CATIPLMNewMinorVersionEngine.
 */
class ExportedByCATPLMIntegrationInterfaces CATIPLMOperationPrecheckAnalyzer : public CATBaseUnknown
{
CATDeclareInterface;

public:
  /**
   * Called once (and only if) the validation step is complete and successful, 
   * and allows to cancel the versioning operation in progress.
   * The issued warnings are available via the error monitor. This method is not
   * called if errors were found.
   * The warnings to expect are:
   * <ul>
   * <li><code>ERR_01</code>: The target 3DPart has no publication.</li>
   * </ul>
   * @param ipErrorMonitor [in] An error monitor containing the issued warnings.
   * @return 
   *  <dl>
   *  <dt><code>S_OK</code> to proceed with versioning operation.</dt>
   *  <dt><code>E_FAIL</code> to cancel the versioning operation.</dt>
   *  </dl>
   */
  virtual HRESULT AnalyzePrecheckResult(CATIAdpErrorMonitor * ipErrorMonitor) = 0;
};

//-----------------------------------------------------------------------
CATDeclareHandler( CATIPLMOperationPrecheckAnalyzer, CATBaseUnknown );

#endif
