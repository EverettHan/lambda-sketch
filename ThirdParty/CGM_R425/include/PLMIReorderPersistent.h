// COPYRIGHT Dassault Systemes 2009
//===================================================================
//
// PLMIReorderPersistent.h
// Define the PLMIReorderPersistent interface
//
//===================================================================
//
// Usage notes:
//   New interface: describe its use here
//
//===================================================================
//
//  Feb 2009  Creation: Code generated by the CAA wizard  WUS
//===================================================================
#ifndef PLMIReorderPersistent_H
#define PLMIReorderPersistent_H

/**
 * @level Protected
 * @usage U3
 */

//------------------------------------------------------------------
#include "CATPLMModelerBaseInterfaces.h"

#include "CATBaseUnknown.h"

class CATListPtrCATIPLMComponent;

#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedByCATPLMModelerBaseInterfaces IID IID_PLMIReorderPersistent;
#else
extern "C" const IID IID_PLMIReorderPersistent ;
#endif
//------------------------------------------------------------------

class CATIPLMComponent;

/**
* Interfaces to persist the order of the children of the component implementing this interface.
*/
class ExportedByCATPLMModelerBaseInterfaces PLMIReorderPersistent: public CATBaseUnknown
{
  CATDeclareInterface;

public:
  /**
  * Types of reorderable children.
  */
  enum PersistentReorderableType
  {
    PRTInstance,
    PRTRepInstance,
    PRTPort,
    PRTConnection,
    PRTUnmanagedType, // Keep after last managed type
  };

  /**
  * Sets a new persistent order for the children of the current component.
  * This method does not propagate the modifications. 
  * The new order can be retrieved through GetChildrenInPersistedOrder, even before propagation.
  *
  * @param iListOrderedComponents
  *    List of components to order. Components can only be of one CoreType.
  * @param iListModifiableComponents
  *    List of modifiable components to order.
  * @return
  * 	 E_INVALIDARG : Elements of different CoreTypes were passed in any of the list.
  * 	 E_FAIL : An internal error occured.
  * 	 S_OK : The new order was set.
  */
  virtual HRESULT PersistChildrenOrder(CATListPtrCATIPLMComponent& iListOrderedComponents,
                                       CATListPtrCATIPLMComponent& iListModifiableComponents) = 0;

  /**
  * Retrieves the children of the current component in their persisted order 
  * (database order or last order set with PersistChildrenOrder).
  * 
  * @param iReorderableType
  *    Type of the children to retrieve.
  * @param oListOrderedChildren
  *    List of retrieved components of the provided type (empty if the type is not managed).
  *    The list must be empty when the method is called.
  *    Each element of the list must be released by the caller after use.
  * @return
  *    E_INVALIDARG : The list was not empty when the method was called.
  *                or The specified type is not managed. The list is returned empty.
  *    E_FAIL : An internal error occured.
  *    S_OK : The children were succesfully retrieved.    
  */
  virtual HRESULT GetChildrenInPersistedOrder(PersistentReorderableType iReorderableType,
                                              CATListPtrCATIPLMComponent& oListOrderedChildren) = 0;

  /**
  * Retrieves the type of a component. Can be usefull, but no impact on order.
  * @return
  * - S_OK if the component type can be retrieved
  * - E_INVALIDARG if the component is of unknown type or is null (type is set to PRTUnmanagedType)
  * - E_FAIL if an unexpected error occurs  
  */
  virtual HRESULT GetReorderableType(CATIPLMComponent* ipComponent, 
                                     PersistentReorderableType& oReorderableType) = 0;

  // No constructors or destructors on this pure virtual base class
  // --------------------------------------------------------------
};

CATDeclareHandler(PLMIReorderPersistent, CATBaseUnknown);

#endif
