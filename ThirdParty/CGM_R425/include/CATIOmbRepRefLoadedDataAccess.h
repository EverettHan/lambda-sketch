// COPYRIGHT Dassault Systemes 2005
//===================================================================
//  Apr 2005  Creation: Code generated by the CAA wizard  phb
//===================================================================
#ifndef CATIOmbRepRefLoadedDataAccess_H
#define CATIOmbRepRefLoadedDataAccess_H

/**
* @level  Protected
* @usage   U3
*/

#include "CATOmbSelectiveLoading.h"
#include "CATBaseUnknown.h"
#include "CATCollec.h"

class CATOmbLoadableDataUniqueKey;
class CATLISTV(CATOmbLoadableDataUniqueKey);

#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedByCATOmbSelectiveLoading IID IID_CATIOmbRepRefLoadedDataAccess;
#else
extern "C" const IID IID_CATIOmbRepRefLoadedDataAccess ;
#endif

//------------------------------------------------------------------
/**
* Interface allowing consultation of Loaded Data of a Representation Reference.
*/
class ExportedByCATOmbSelectiveLoading CATIOmbRepRefLoadedDataAccess: public CATBaseUnknown
{
	CATDeclareInterface;

public:
	/**
	* Retrieves the list of the keys identifying the loaded documents held by the Representation Reference.
	*
	* @param oLst
	*	The retrieved list (may change on Representation Reference Loading mode switch).
	*/
	virtual HRESULT ListLoadedDataKeys ( CATLISTV(CATOmbLoadableDataUniqueKey)&  oLst ) = 0;

	/**
	* Retrieves a loaded document held by the Representation Reference.
	*
	* @param iKey
	*	A key got from 'ListLoadedDataKeys' method.
	*
	* @param oData [out, CATBaseUnknown#Release]
	*	The retrieved document.
  * It must be release'd after usage.
  * 
  * @return 
  * <ul>
  *   <li> S_OK : A loaded document has been found for this key
  *   <li> E_FAIL : No document loaded for the given key
  * </ul>
	*/
	virtual HRESULT GetLoadedData(const CATOmbLoadableDataUniqueKey&  iKey,CATBaseUnknown*& oData) = 0;
};

//------------------------------------------------------------------
CATDeclareHandler( CATIOmbRepRefLoadedDataAccess, CATBaseUnknown );

#endif
