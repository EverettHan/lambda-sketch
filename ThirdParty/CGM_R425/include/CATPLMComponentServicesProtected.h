// COPYRIGHT Dassault Systemes 2006
//===================================================================
//
// CATPLMComponentServicesProtected.h
// Header definition of CATPLMComponentServicesProtected
//
//===================================================================
//
// Usage notes:
//
//===================================================================
//
//  Jan 2006  Creation: Code generated by the CAA wizard  ECN
//===================================================================
/**
  * @level Protected
  * @usage U1
  */
#ifndef CATPLMComponentServicesProtected_H
#define CATPLMComponentServicesProtected_H

#include "CATBaseUnknown.h"
#include "CATPLMComponentInterfaces.h"
#include "CATListPtrCATIPLMComponent.h"

class CATIPLMComponent;
class CATIPLMNavOccurrence;
class CATOmxKeyValueBlock;

//-----------------------------------------------------------------------

/**
* Class to access services on PLM component in current session.
*
* <br><b>Role</b>: this class provides an access to PLM components in current session.
*
*/
enum CATPLMComponentCompletionLevel
{
  CompletionLevelUndefined = 0,
  CompletionLevelIdentification = 1,
  CompletionLevelNavigation = 2,
  CompletionLevelAuthoring = 3
};

class ExportedByCATPLMComponentInterfaces CATPLMComponentServicesProtected
{
public:

  /**
  * Get the completion level of a PLM Component loaded in client session
  *
  * @param iPLMComponent
  *   The PLM component
  *
  * @param oCompletionLevel
  *   Identification : the component is present, but it is empty, no attributes can be accessed, edition is not possible.
  *   Navigation     : the component is partially loaded, only required attributes are accessible, edition is not possible.
  *   Authoring      : the component is fully loaded, all attributes are accessible, edition is possible.
  *   Undefined      : the completion level of the component cannot be computed.
  *
  * @return
  *      S_OK if succeeded <br>
  *      E_FAIL if failed <br>
  */
  static HRESULT GetCompletionLevel(CATIPLMComponent * iPLMComponent, CATPLMComponentCompletionLevel & oCompletionLevel);

/**
 * Does not work
 * @deprecated 
 * @use PLMModelerBaseInterfaces.CATIOccurrenceServices3
 */
  static HRESULT GetOccurrenceFromPathInstances(CATListPtrCATIPLMComponent &iInstances, CATIPLMNavOccurrence*& oOccurence, CATIPLMNavOccurrence* iOccurenceContext = NULL);

  /**
  * Retrieves the values of a list of public attributes attached to the Component.
  *   WARNING: this list is usable for information and display, not for attribute management.
  * @param iAttributeNameList
  *   The list of attributes' internal name.
  *   <br><b>Legal values</b>:
  *   <dl>
  *     <dd>the values of the attributes which name is in this list have to be returned.</dd>
  *   </dl>
  * @param oAttributeValueList
  *   The list of attributes' value. It is is cleaned before treatment.
  *   <br><b>Legal values</b>:
  *   <dl>
  *     <dt>Filled</dt>
  *     <dd>The list of values of required attributes. If succes, this list has the same size than the previous one. Else this is Empty</dd>
  *   </dl>
  * @return
  *   HRESULT
  *   <br><b>Legal values</b>:
  *   <dl>
  *     <dt>S_OK</dt>
  *     <dd>The list is successfully returned.</dd>
  *     <dt>E_INVALIDARG</dt>
  *     <dd>The iPLMComponent is NULL or the iAttributeNameList is empty.</dd>
  *     <dt>E_FAIL</dt>
  *     <dd>If an error occurs.</dd>
  *   </dl>
  */
  static HRESULT GetAttributesForDisplay(CATIPLMComponent * iPLMComponent,
    CATListOfCATUnicodeString & iAttributeNameList,
    CATListOfCATUnicodeString & oAttributeValueList);

};

//-----------------------------------------------------------------------

#endif
