//===================================================================
// COPYRIGHT Dassault Systemes 2017/05/18
//===================================================================
// CATPLMAutoNamingLocalGenerator.cpp
// Header definition of class CATPLMAutoNamingLocalGenerator
//===================================================================
//
// Usage notes:
//
//===================================================================
//  2017/05/18 Creation: Code generated by the 3DS wizard
//===================================================================

#ifndef CATPLMAutoNamingLocalGenerator_H
#define CATPLMAutoNamingLocalGenerator_H

#include "CATPLMImplAdapterBase.h"
#include "CATPLMAutoNamingInput.h"
#include "CATPLMAutoNamingOutput.h"
#include "CATOmxOMap.h"

//-----------------------------------------------------------------------

class ExportedByCATPLMImplAdapterBase CATPLMAutoNamingLocalGenerator
{
public:

  static CATPLMAutoNamingLocalGenerator& GetInstance();

  /*
  * Generates the requested number of names locally.
  * It does not make a call on the provider.
  *
  * When online mode:
  *   It returns a simple local counter
  *   Example: 1
  *
  * When offline mode:
  *   It uses offline naming template and a local counter.
  *   The output format:
  *     _%u_%t_%d
  *       %u -> connected user
  *       %t -> UCS timestamp
  *       %d -> generated id (integer incremented for each type, begin at 1)
  *   Example: _uxodtitp_1495096403_1
  *
  * Result is stored in oOutput.
  *
  * /!\ Note: When PLMBL_FORCE_SERVER_KEY_IN_ODT_ENV is enabled, generated names are UUID (TSTProvider legacy mode)
  */
  HRESULT GenerateLocalNames(const char* iRepository, const CATOmxVector<CATPLMAutoNamingInput>& iInputs, CATPLMAutoNamingOutput* oOutput);
  HRESULT GenerateLocalName(const char *iRepository, const CATPLMAutoNamingInput* iInput, CATPLMAutoNamingOutput* oOutput);

private:
  CATPLMAutoNamingLocalGenerator();
  virtual ~CATPLMAutoNamingLocalGenerator();
  CATPLMAutoNamingLocalGenerator(CATPLMAutoNamingLocalGenerator &);
  CATPLMAutoNamingLocalGenerator& operator=(CATPLMAutoNamingLocalGenerator&);

  // Key: AutoNamingInput key / Value: id counter (start at 1, incremented each time auto name requested)
  CATOmxOMap<CATUnicodeString, CATULONG64, CATOmxDefaultCollecManager<CATUnicodeString>::manager, CATOmxDefaultCollecManager<CATULONG64>::manager> _AutoNamingTable;
};

//-----------------------------------------------------------------------

#endif
