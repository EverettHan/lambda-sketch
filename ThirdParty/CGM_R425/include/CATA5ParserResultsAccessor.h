//===================================================================
// COPYRIGHT Dassault Systemes 2017/12/20
//===================================================================
// CATA5ParserResultsAccessor.cpp
// Header definition of class CATA5ParserResultsAccessor
//===================================================================
//
// Usage notes:
//
//===================================================================
//  2017/12/20 Creation: Code generated by the 3DS wizard
//===================================================================

#ifndef CATA5ParserResultsAccessor_H
#define CATA5ParserResultsAccessor_H

#include "CATA5Parser.h"

#include "CATA5Parser.h"

class ExportedByCATA5Parser CATA5ParserResultsAccessor
{
public:
  CATA5ParserResultsAccessor(CATA5::Parser* ipParser = NULL);
  virtual ~CATA5ParserResultsAccessor();

  void Initialize(CATA5::Parser* ipParser);

  /**
  * Returns the next parsed line from a tcl output
  * If called within an OnProgressCB, this API will return only the row already parsed. When API will end in S_FALSE, some rows may still have to be processed (usually in OnTaskCompleted)
  * This API retrieves first rows that are already parsed. In OnTaskCompleted if no more rows are available, it will  wait for the completion of the parsing to return the missing rows
  * @param
  * <br/> [out] oRow   : a line parsed from a tcl output
  * <br/> [out] oRowDef: the label associated to this line in the tcl output
  * @return
  * <code>S_OK</code>: next line has been retrieved successfully
  * <code>S_FALSE</code>: no more line to process.
  * <code>E_FAIL</code>: generic parsing error
  * <code>E_UNEXPECTED</code>: the return row contains an error.
  */
  HRESULT GetNextRow(CATOmxArray<CATOmxAny>& oRow, CATOmxKeyString& oRowDef, CATBoolean iWaitForResults = FALSE);

  HRESULT GetNextRow(CATOmxSR<CATA5::CsvRow>& oRow, CATBoolean iWaitForResults = FALSE);

  /**
  * Returns the next parsed line from a tcl output
  * If called within an OnProgressCB, this API will return only the row already parsed. When API will end in S_FALSE, some rows may still have to be processed (usually in OnTaskCompleted)
  * This API retrieves first rows that are already parsed. In OnTaskCompleted if no more rows are available, it will  wait for the completion of the parsing to return the missing rows
  * @param
  * <br/> [out] oKVB   : a line parsed from a tcl output as a KVB
  * <br/> [out] oRowDef: the label associated to this line in the tcl output
  * @return
  * <code>S_OK</code>: next line has been retrieved successfully
  * <code>S_FALSE</code>: no more line to process.
  * <code>E_FAIL</code>: generic parsing error
  * <code>E_UNEXPECTED</code>: the return row contains an error.
  */
  HRESULT GetNextRowAsKVB(CATOmxKeyValueBlock& oKVB, CATOmxKeyString& oRowDef, CATBoolean iWaitForResults = FALSE);

private:
  CATA5::CsvRowChunk* _pCurrentCsvRowChunk; // Current CsvRow chunk retrieved from parser. This chunk may contain up to 256 CsvRow.
  CATULONG32 _CurrentCsvRowIndex;  // Current index in current CsvRowChunk.
  CATOmxSR<CATA5::Parser> _spParser;
};

#endif
