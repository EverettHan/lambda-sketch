//===================================================================
// COPYRIGHT Dassault Systemes 2013/04/29
//===================================================================
// UIScriptCtl.cpp
// Header definition of class UIScriptCtl
//===================================================================
//
// Usage notes:
//
//===================================================================
//  2013/04/29 Creation: Code generated by the 3DS wizard
//===================================================================

#ifndef UIScriptCtl_H
#define UIScriptCtl_H

#include "UIScriptVID.h"

//VisuImmersiveDialog
#include "CATVidCtl.h"

//IntrospectionInfrastructure
#include "CATISYPIntrospectable.h"

class UIScriptContext; 

//-----------------------------------------------------------------------

class ExportedByUIScriptVID UIScriptCtl: public CATVidCtl
{
  CATDeclareClass; 

public:
  UIScriptCtl ();
  UIScriptCtl (UIScriptContext* iCtx); 

  UIScriptContext* GetContext() { return _ctx; }

  // Script Name
  void SetScript(const CATUnicodeString& iScriptName); 
  CATUnicodeString GetScript() const { return _scriptName; }
    
  // Data
  CATISYPIntrospectable_var GetData();
  void SetData( CATISYPIntrospectable_var ispDataBlock );

  // Set a new context for the control
  void SetContext(UIScriptContext* iCtx);

protected: 
  virtual ~UIScriptCtl ();

  void _CreateInternalContext();
  HRESULT _CreateCtlScriptedObject();
private:

  void RegisterPrivateBindings(); 
  void SetPrivateScript(const CATUnicodeString& iScriptName);

  // Copy constructor and equal operator
  // -----------------------------------
  UIScriptCtl (UIScriptCtl &);
  UIScriptCtl& operator=(UIScriptCtl&);

  UIScriptContext* _ctx; 
  CATBoolean _destroyContextOnDestruction;
  CATISYPIntrospectable_var  _spData;
  CATUnicodeString _scriptName; 

  friend class UIScriptVIDPrivateBinder;
  friend class UIScriptTst_UIScriptVIDBinder;

};

//-----------------------------------------------------------------------

#endif
