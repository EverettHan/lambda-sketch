/* -*-c++-*- */
// COPYRIGHT Dassault Systemes 2005
//===================================================================
//
// CATIOmbOleNonCATIADocument.h
// Define the CATIOmbOleNonCATIADocument interface
//
//===================================================================
//
// Usage notes:
//   New interface: describe its use here
//
//===================================================================
//
//  Feb 2005  Creation: Code generated by the CAA wizard  vcs
//===================================================================
#ifndef CATIOmbOleNonCATIADocument_H
#define CATIOmbOleNonCATIADocument_H

// pour livraison croisée avec CDMDocument 03/06/2009. To be removed four weeks later
#define CATOmbSelectiveLoadingForModelerOnly_v2

/**
* @level Protected
* @usage U3
*/

#include "CATOmbNonCATIADocument.h"
#include "CATBaseUnknown.h"

#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedByCATOmbNonCATIADocument IID IID_CATIOmbOleNonCATIADocument;
#else
extern "C" const IID IID_CATIOmbOleNonCATIADocument ;
#endif

//------------------------------------------------------------------

/**
* Interface to manage OLE communication with non CATIA documents. 
* <br><b>Role:</b> Enables OLE dialog capabilities between a CATIA document and an external
* <br> document editable in Microsoft Windows environments (like .xls,.doc files for example).
* <br> 
* <br> This interface is designed to add OLE capabilities to the CATNonCATIADocument
* <br> envelope document representing the external Non CATIA file in CATIA memory.
* <br>
* <br> In order to enable these capabilities, the external Non CATIA file MUST have been 
* <br> previously projected in a file system (To do this, use @href CATIOmbNonCATIADocument interface
* <br> on the CATNonCATIADocument document).
* <br>
* <br> Use it the following way:
* <ul>
* <li>EnableOleManagement: allocates Ole resources</li>
* <li>Dialog with the external file... </li>
* <li>DisableOleManagement: frees Ole resources as soon as possible </li>
* </ul>
* <br> Warning: <i>this interface is NOT implemented for UNIX operating systems.</i>
* <br>
*/

class ExportedByCATOmbNonCATIADocument CATIOmbOleNonCATIADocument: public CATBaseUnknown
{
  CATDeclareInterface;

  public:

  /**
  * Enables all OLE management resources on Non CATIA Document currently handled:
  * - allocates in memory all OLE dialog objects requested for communication
  * - activates external document change notifications that user may want to be 
  *   warned on, thru its own callbacks declaration
  *  
  * @return
  *        S_OK   : Succesfully ended
  * <br>   S_FALSE: No projection file found for this external document.
  * <br>            Project it before using this service.
  * <br>   E_FAIL : A software error occured 
  *
  **/
  	virtual HRESULT EnableOleManagement() = 0;

  /**
  * Disables all OLE management resources on Non CATIA Document currently handled:
  * - frees in memory all OLE dialog objects requested for communication
  * - Deactivates all external document change notifications.
  *  
  * @return
  *        S_OK   : Succesfully ended
  * <br>   S_FALSE: No projection file found for this external document.
  * <br>            Project it before using this service.
  * <br>   E_FAIL : A software error occured 
  *
  **/
	virtual HRESULT DisableOleManagement() = 0;

  /**
  * Opens the Non CATIA document projection in its dedicated editor 
  *  
  * @return
  *        S_OK   : Succesfully ended
  * <br>   S_FALSE: No projection file found for this external document.
  * <br>            Project it before using this service.
  * <br>   E_FAIL : A software error occured 
  *
  **/
	virtual HRESULT OpenProjection() = 0;

};

//------------------------------------------------------------------
//   Handling capability (smart pointer)
//------------------------------------------------------------------

CATDeclareHandler( CATIOmbOleNonCATIADocument, CATBaseUnknown ) ;

//------------------------------------------------------------------

#endif
