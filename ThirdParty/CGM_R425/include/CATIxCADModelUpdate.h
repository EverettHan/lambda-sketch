//===================================================================
// COPYRIGHT Dassault Systemes 2020/06/11
//===================================================================
// CATIxCADModelUpdate.cpp
// Header definition of class CATIxCADModelUpdate
//===================================================================
//
// Usage notes:
//
//===================================================================
//  2020/06/11 Creation: Code generated by the 3DS wizard
//===================================================================
#ifndef CATIxCADModelUpdate_H
#define CATIxCADModelUpdate_H

#include "CATLifSpecs.h"
#include "CATListPV.h"
#include "CATUnicodeString.h"
#include "CATBaseUnknown.h"


class ExportedByCATLifSpecs CATxCADParameterInfo
{
public:
  CATUnicodeString _Name;
  CATUnicodeString _Value; // mks value converted in string format
  CATUnicodeString _CustomField;
};

class ExportedByCATLifSpecs CATxCADUpdateAnswer
{
public:
  CATBoolean _UpdateStatus; // true if update succeeds
  CATUnicodeString _ShortMessage;
  CATUnicodeString _LongMessage;
};


extern ExportedByCATLifSpecs  IID IID_CATIxCADModelUpdate;

// class should be implemented thru an extension of CATxCADModelUpdate latetype
// (caller with create CATObject("CATxCADModelUpdate") and make a QI)
// interface implementation must inherit from CATxCADModelUpdateAdapter
class ExportedByCATLifSpecs CATIxCADModelUpdate : public CATBaseUnknown
{
  CATDeclareInterface;

public:

  // iParams is a list of pointers of CATxCADParameterInfo
  // caller manages the life cycle...
  virtual HRESULT UpdateModel(const CATUnicodeString &ixCADOrigin, const CATBaseUnknown_var &iRoot, const CATListPV &iParams, int iTimeOut, CATxCADUpdateAnswer &oAnswer) = 0;

  // this is necessary for the PLM update to know the parametric bridge in order to know the components 
  // to refresh. It is called just before UpdateModel method.
  virtual void SetParametricBridge(const CATBaseUnknown_var &iPB) = 0;
};

//-----------------------------------------------------------------------
CATDeclareHandler(CATIxCADModelUpdate, CATBaseUnknown);

#endif
