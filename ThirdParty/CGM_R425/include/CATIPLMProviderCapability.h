// COPYRIGHT Dassault Systemes 2004
//===================================================================
//
// CATIPLMProviderCapability.h
// Define the CATIPLMProviderCapability interface
//
//===================================================================
//
// Usage notes:
//   New interface: describe its use here
//
//===================================================================
//
//  May 2004  Creation: Code generated by the CAA wizard  jsy
//===================================================================
/**
* @level Protected
* @usage U3
*/
#ifndef CATIPLMProviderCapability_H
#define CATIPLMProviderCapability_H

#include "CATPLMServicesItf.h"
#include "CATBaseUnknown.h"
#include "CATPLMProviderCapabilityEnum.h"
#include "CATPLMPropertyEnum.h"
#include "CATLib.h"

#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedByCATPLMServicesItf IID IID_CATIPLMProviderCapability;
#else
extern "C" const IID IID_CATIPLMProviderCapability ;
#endif

class CATPLMRepositoryName;
class CATUnicodeString;
class CATOmxAny;

/**
 * Handles the capability request of PLMAdapter to the providers.
 * The answers are used to give an answer to a Provider Feature request.
 *
 */
class ExportedByCATPLMServicesItf CATIPLMProviderCapability: public CATBaseUnknown
{
  CATDeclareInterface;

  public:
  /**
   * Returns a capability level of implementation.
   * 
   * @param iCapabilityRequest
   *  The capability asked to the provider.
   * @param oResult
   *  The answer of the provider.
   * @param iCheckInstanceLevel
   *   Value = 0 : the provider gives the result for the current client level
   *   Value = 1 : the provider gives the result for the level of the connection
   * @return
   *  S_OK    : everything is OK. The answer is readable (even CR_NotImpl)
   *  E_FAIL  : oResult is CR_Unknown.
   */
   virtual HRESULT QueryCapability (const CATPLMProviderCapabilityEnum iCapabilityRequest
                                   ,CATPLMProviderCapabilityResult &oResult
                                   ,int iCheckInstanceLevel ) = 0;

  /**
   * Returns a capability level of implementation.
   * Called for documentation of all CATIA levels.
   * 
   * @param iCapabilityRequest
   *  The capability asked to the provider.
   * @param iMLCLevel
   *  Gives the answer for this level.
   * @param oResult
   *  The answer of the provider.
   * @param oComment
   *  If available, a comment provided by the provider for this capability. 
   *  Filled only if not NULL.
   * @return
   *  S_OK    : everything is OK. The answer is readable (even CR_NotImpl)
   *  E_FAIL  : oResult is CR_Unknown.
   */
   virtual HRESULT QueryCapability (const CATPLMProviderCapabilityEnum iCapabilityRequest
                                   ,CATIALevelInfo &iMLCLevel
                                   ,CATPLMProviderCapabilityResult &oResult
                                   ,CATUnicodeString *oComment) = 0;


  /**
   * Returns a Property.
   * 
   * Note: A property is different from a capacity. It returns a value to use as a base.
   * @param iProperty
   *  The property to request.
   * @param oValue
   *  The value returned by the provider. The type of the any depends on the property, see documentation of the property.
   * @return
   *  S_OK    : everything is OK.
   *  S_FALSE : Instance of provider was not connected or the default value was returned.
   */
   virtual HRESULT GetProperty (const CATPLMPropertyEnum iProperty
                                ,CATOmxAny &oValue ) = 0;

};
#endif
