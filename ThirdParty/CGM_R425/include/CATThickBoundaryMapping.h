#ifndef CATThickBoundaryMapping_H
#define CATThickBoundaryMapping_H

// COPYRIGHT DASSAULT SYSTEMES 1999

#include "Thick.h"
class CATThick;
#include "CATListOfInt.h"
#include "ListPOfCATCell.h"

// Global function returning tables that define a mapping between the
// boundaries of a skin and its offset, generated by a CATThick operator

// All input lists should be empty, otherwise the mapping lists will 
// simply be appended to the given input lists

// If the CATThick operand is not a skin, input lists will remain untouched
// (therefore empty if they were empty before)

// oCCxSizes . Size() = number of connected components (number of shells)
// oCCxSizes[k]       =  number of closed boundaries in shell number k

// oCycleSizes . Size() = total number of closed boundaries (closed loops made
//                        of consecutive edges bordering only one face) in initial 
//                        or final skin (same number of closed boundaries assumed)
// oCycleSizes[k]       = number of cells (edges + vertices) in cycle number k
//                        in initial skin (number can be different in final skin)

// oInitBdCell . Size() = total number of boundary cells (vertices + edges) in
//                        initial skin
// oInitBdCell[k]       = vertex or edge belonging to the boundary of initial skin
//                        each sequence defining a closed boundary starts with a
//                        vertex and ends up with an edge. Vertices and edges are
//                        given in alternance. Therefore, odd numbers always yield
//                        vertices, and even numbers always yield edges
//                        (since numbers start from 1, not from zero)

// oImageBdCell . Size() = total number of boundary cells (vertices + edges) in
//                         final skin
// oImageBdCell[k]       = vertex or edge belonging to the boundary of final skin
//                         the internal structure is the same as oInitBdCell list

// oImageStartCellNumber . Size() = oImageEndCellNumber . Size() = oInitBdCell . Size()
//                         (the three lists are parallel)

// The offset image of oInitBdCell[k] (a vertex or an edge) consists in all cells 
// in oImageBdCell, starting from number oImageStartCellNumber[k] and ending at
// number oImageEndCellNumber[k]

ExportedByThick void GetSkinBorderMapping(const CATThick    * iOpe,
                                          CATListOfInt      & oCCxSizes,
                                          CATListOfInt      & oCycleSizes,
                                          CATLISTP(CATCell) & oInitBdCell,
                                          CATLISTP(CATCell) & oImageBdCell,
                                          CATListOfInt      & oImageStartCellNumber,
                                          CATListOfInt      & oImageEndCellNumber);

                                          
// Global function used to merge two border-mappings
ExportedByThick void MergeMappings(const CATThick    * iOpe1,
                                   const CATThick    * iOpe2,
                                   CATListOfInt      & oCCxSizes,
                                   CATListOfInt      & oCycleSizes,
                                   CATLISTP(CATCell) & oInitBdCell,
                                   CATLISTP(CATCell) & oImageBdCell,
                                   CATListOfInt      & oImageStartCellNumber,
                                   CATListOfInt      & oImageEndCellNumber,
                                   short             & oMergeDiag);

// Returns the isotopological border info of the resulting body
ExportedByThick short IsIsoTopologicalBorderResult(const CATThick    * iOpe);
#endif
